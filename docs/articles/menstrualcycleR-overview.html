<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting Started with menstrualcycleR and Phase-Aligned Cycle Time Scaling (PACTS) • menstrualcycleR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started with menstrualcycleR and Phase-Aligned Cycle Time Scaling (PACTS)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">menstrualcycleR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/menstrualcycleR-overview.html">Getting Started with menstrualcycleR and Phase-Aligned Cycle Time Scaling (PACTS)</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Getting Started with menstrualcycleR and Phase-Aligned Cycle Time Scaling (PACTS)</h1>
                        <h4 data-toc-skip class="author">Anisha Nagpal,
Tory Eisenlohr-Moul</h4>
            
      

      <div class="d-none name"><code>menstrualcycleR-overview.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="what-is-pacts-scaled-cycle-time-and-menstrualcycler">What is PACTS, Scaled Cycle Time, and
<code>menstrualcycleR</code>?<a class="anchor" aria-label="anchor" href="#what-is-pacts-scaled-cycle-time-and-menstrualcycler"></a>
</h2>
<div class="section level3">
<h3 id="understanding-the-challenge">Understanding the Challenge<a class="anchor" aria-label="anchor" href="#understanding-the-challenge"></a>
</h3>
<p>Despite decades of research, there is still no standard method for
operationalizing the menstrual cycle as a <strong>continuous and
cyclical biological process</strong>. Traditional approaches—such as
categorical phase labels or linear day-counting methods—oversimplify the
cycle and introduce misalignment with underlying hormonal patterns.
These methods often assume ovulation occurs at cycle midpoint and ignore
variation in follicular versus luteal phase lengths, leading to reduced
power, misclassification, and inconsistent findings across studies.</p>
<hr>
</div>
<div class="section level3">
<h3 id="introducing-pacts">Introducing PACTS<a class="anchor" aria-label="anchor" href="#introducing-pacts"></a>
</h3>
<p><strong>Phase-Aligned Cycle Time Scaling (PACTS)</strong> is a method
that standardizes menstrual cycle time as a continuous variable aligned
to <strong>hormonally meaningful anchors</strong>:<br>
- <strong>Menses onset</strong> - <strong>Ovulation</strong></p>
<p>Rather than dividing the cycle into arbitrary phases or counting
forward from menses, PACTS treats the cycle as a <strong>dynamic,
time-varying system</strong> and provides a framework to realign
repeated measures (e.g., mood, symptoms, physiology) across individuals
and cycles.</p>
<p>The PACTS method is implemented in the R package
<code>menstrualcycleR</code>, which provides tools for: - Assigning
cycle days and cycle numbers - Estimating or importing ovulation
information - Creating scaled time variables centered on ovulation or
menses - Visualizing and checking cycle-level data</p>
<hr>
</div>
<div class="section level3">
<h3 id="why-continuous-cycle-modeling">Why Continuous Cycle Modeling?<a class="anchor" aria-label="anchor" href="#why-continuous-cycle-modeling"></a>
</h3>
<p>Shifting from categorical phase-based methods to continuous modeling
offers several advantages:</p>
<ul>
<li>
<strong>Increased statistical power</strong>: More observations per
cycle can be included in analyses without discarding off-phase
days.</li>
<li>
<strong>Better precision</strong>: Continuous time captures subtle,
within-phase changes that are masked by averaging over phases.</li>
<li>
<strong>More flexible modeling</strong>: Mixed-effects models,
splines, and time-varying predictors can be used to model within- and
between-person variation in cycle dynamics.</li>
</ul>
<p>See Eisenlohr-Moul et al. (2020), Schmalenberger et al. (2024), and
Reen &amp; Kiesner (2016) for supporting discussions.</p>
<hr>
</div>
<div class="section level3">
<h3 id="anchoring-on-ovulation-and-menses">Anchoring on Ovulation and Menses<a class="anchor" aria-label="anchor" href="#anchoring-on-ovulation-and-menses"></a>
</h3>
<p>Most prior approaches count days forward from menses onset or
backward from the end of the cycle, but <strong>they fail to align data
by ovulation</strong>, which is the key inflection point in hormonal
dynamics.</p>
<ul>
<li>The <strong>follicular phase</strong> (from menses to ovulation) is
highly variable in length.</li>
<li>The <strong>luteal phase</strong> (from ovulation to next menses) is
more consistent across individuals and cycles.</li>
</ul>
<p>Accordingly, PACTS assigns scaled time using: - <strong>Ovulation day
= 0</strong> when modeling ovulation-centered dynamics - <strong>Menses
day = 0</strong> when studying perimenstrual processes (e.g.,
dysmenorrhea)</p>
<p>When modeling menses-centered, the cycle is scaled from -1 to +1,
with menses = 0, with negative values representing the <strong>luteal
phase</strong> and positive values representing the <strong>follicular
phase</strong>. When modeling ovulation-centered, estimated day of
ovulation = 0, and psotive values represent the <strong>follicular
phase</strong> and negative values represent the <strong>luteal
phase</strong>. This allows for flexible model fitting while retaining a
biologically meaningful time structure.</p>
<hr>
</div>
<div class="section level3">
<h3 id="estimating-ovulation-when-biomarkers-are-unavailable">Estimating Ovulation When Biomarkers Are Unavailable<a class="anchor" aria-label="anchor" href="#estimating-ovulation-when-biomarkers-are-unavailable"></a>
</h3>
<p>When ovulation is not confirmed using biomarkers (e.g., LH surge,
BBT), PACTS uses a population-average method by assigning the
<strong>day of ovulation as 15 days prior to the next menses
onset</strong> (i.e., the last day of the follicular phase).</p>
<p>This backward-counting method is preferable to mid-cycle assumptions,
which often misclassify ovulation in cycles with short or long
follicular phases. The use of biomarkers is still recommended whenever
possible to ensure precise alignment.</p>
<p>Functions in <code>menstrualcycleR</code> automatically flag imputed
ovulation using a binary column (<code>ovtoday_impute</code>) so that
users can report and model uncertainty.</p>
<hr>
</div>
<div class="section level3">
<h3 id="purpose-and-use-cases">Purpose and Use Cases<a class="anchor" aria-label="anchor" href="#purpose-and-use-cases"></a>
</h3>
<p>The ultimate goal of PACTS and <code>menstrualcycleR</code> is to
provide an open, reproducible framework to support cycle-based research
in: - <strong>Affective and behavioral science</strong> -
<strong>Clinical research on hormone-related disorders</strong> (e.g.,
PMDD, catamenial epilepsy) - <strong>Women’s health and precision
medicine</strong></p>
<p>By using a continuous, biologically aligned cycle time variable,
researchers can better detect nuanced patterns in symptoms, physiology,
and behavior that vary across the menstrual cycle.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="data-requirements-for-utilizing-pacts-and-menstrualcycler">Data Requirements for Utilizing PACTS and
<code>menstrualcycleR</code><a class="anchor" aria-label="anchor" href="#data-requirements-for-utilizing-pacts-and-menstrualcycler"></a>
</h2>
<p>To apply the Phase-Aligned Cycle Time Scaling (PACTS) method and
other core functionalities of the <code>menstrualcycleR</code> package,
researchers must ensure their dataset meets several key criteria:</p>
<div class="section level3">
<h3 id="daily-data-with-self-reported-menses-onset">1. <strong>Daily Data with Self-Reported Menses Onset</strong><a class="anchor" aria-label="anchor" href="#daily-data-with-self-reported-menses-onset"></a>
</h3>
<p>Accurate identification of menstrual cycle boundaries is essential.
At a minimum, the dataset must include:</p>
<ul>
<li>
<strong>Self-reported menses onset dates</strong> throughout the
study period<br>
</li>
<li>
<strong>The next menses onset date following study
completion</strong>, to ensure full-cycle alignment</li>
</ul>
<p>These dates are used to define the start of each cycle and compute
standardized time variables.</p>
<blockquote>
<p><strong>Note:</strong> Menses onset cannot be imputed and must be
provided for all usable cycles.</p>
</blockquote>
<hr>
</div>
<div class="section level3">
<h3 id="ovulation-assessment-or-imputation">2. <strong>Ovulation Assessment or Imputation</strong><a class="anchor" aria-label="anchor" href="#ovulation-assessment-or-imputation"></a>
</h3>
<p>The estimated day of ovulation (EDO) is required for analyses
centered on the ovulatory phase. Ovulation may be:</p>
<ul>
<li>
<strong>Directly confirmed</strong> using biomarkers such as:
<ul>
<li>Luteinizing hormone (LH) tests (EDO is day after positive test, LH+1
and must be reflected in input dataset)</li>
<li>Basal body temperature (BBT) (EDO is day after the nadir, nadir+1
and must be reflected in input dataset)</li>
<li>Ultrasound or hormone assays</li>
</ul>
</li>
<li>
<strong>Imputed</strong>, if biomarkers are unavailable, based on
the assumption of a 14–15 day luteal phase. In this case, ovulation is
assigned as <strong>15 days before the next menses onset</strong> by
<code>menstrualcycleR</code>
</li>
</ul>
<p>Imputed ovulation days are recorded in a binary column,
<code>ovtoday_impute</code>, created when using
<code>menstrualcycleR</code> distinguishing them from confirmed values.
Researchers are strongly encouraged to report the proportion of
confirmed versus imputed ovulation days for transparency and scientific
rigor.</p>
<hr>
</div>
<div class="section level3">
<h3 id="cycle-length-inclusion-criteria">3. <strong>Cycle Length Inclusion Criteria</strong><a class="anchor" aria-label="anchor" href="#cycle-length-inclusion-criteria"></a>
</h3>
<p>By default, <code>menstrualcycleR</code> includes only cycles between
<strong>21 and 35 days</strong> in length for standardized time variable
computation. Cycles outside this range are excluded because they often
show:</p>
<ul>
<li>Greater variability in timing</li>
<li>Increased likelihood of anovulation</li>
</ul>
<p>This range can be modified by the user, especially in cases where
ovulation is confirmed for all cycles and the study population includes
naturally shorter or longer cycles.</p>
<p>Additonally, <code>menstrualcycleR</code> will only scale luteal
phases if the length is <strong>7 and 18 days</strong>. This judgement
is based on norms from over 600,000 ovulatory cycles reported in Bull et
al., (2019).</p>
<hr>
</div>
<div class="section level3">
<h3 id="supported-variables-and-formats">4. <strong>Supported Variables and Formats</strong><a class="anchor" aria-label="anchor" href="#supported-variables-and-formats"></a>
</h3>
<p>The dataset should include the following columns:</p>
<table class="table">
<colgroup>
<col width="28%">
<col width="71%">
</colgroup>
<thead><tr class="header">
<th>Column Name</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>id</code></td>
<td>Unique participant identifier that needs to be a <strong>numeric
type</strong>, it cannot be labeled with characters such as ID001,
ID002, …</td>
</tr>
<tr class="even">
<td><code>date</code></td>
<td>Calendar date of each observation. Ensure all id-date combinations
are unique. You may wish to reclassify post-midnight survey entries to
the previous day to maintain alignment with sleep or daily tracking
data.</td>
</tr>
<tr class="odd">
<td><code>menses</code></td>
<td>Binary indicator of <strong>menses onset</strong> (1 = yes, 0 = no)/
first day of menstruation. Periovulatory spotting should also be
excluded.</td>
</tr>
<tr class="even">
<td><code>ovtoday</code></td>
<td>Binary indicator of confirmed ovulation day (optional)</td>
</tr>
<tr class="odd">
<td><code>symptom variables</code></td>
<td>Daily ratings of outcomes</td>
</tr>
</tbody>
</table>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="installation-of-the-menstrualcycler-package">Installation of the <code>menstrualcycleR</code> package<a class="anchor" aria-label="anchor" href="#installation-of-the-menstrualcycler-package"></a>
</h2>
<p>Currently the <code>menstrualcycleR</code> package is hosted on the
Eisenlohr-Moul Lab’s (CLEAR Lab: Clarifying the Endocrinology of Acute
Risk) GitHub repository.</p>
<p>To install it from GitHub, install and load the package `remotes`` by
running:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://remotes.r-lib.org" class="external-link">remotes</a></span><span class="op">)</span></span></code></pre></div>
<p>then install and load the <code>menstrualcycleR</code> package by
running:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"eisenlohrmoullab/menstrualcycleR"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://osf.io/preprints/osf/hd5xw_v1?view_only=" class="external-link">menstrualcycleR</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Welcome to the menstrualcycleR package!</span></span>
<span><span class="co">#&gt; If you use this package, please cite:</span></span>
<span><span class="co">#&gt; Nagpal, A., Schmalenberger, K. M., Barone, J., Mulligan, E. M., Stumper, A., Knol, L., … Eisenlohr-Moul, T. A., PhD. (2025, May 6). Studying the Menstrual Cycle as a Continuous Variable: Implementing Phase-Aligned Cycle Time Scaling (PACTS) with the `menstrualcycleR` package. https://doi.org/10.31219/osf.io/hd5xw_v1</span></span></code></pre></div>
<p>Note that the <code>menstrualcycleR</code> package depends on several
other packages (mostly packages from the <a href="https://www.tidyverse.org/" class="external-link"><code>tidyverse</code> suite</a>).</p>
<p>This vignette also uses <code>tidyverse</code> functions so it is
recommended to install and load the <code>tidyverse</code> suite by
running:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"tidyverse"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Attaching core tidyverse packages</span> ──────────────────────── tidyverse 2.0.0 ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr    </span> 1.1.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">readr    </span> 2.1.5</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats  </span> 1.0.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">stringr  </span> 1.5.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2  </span> 3.5.2     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble   </span> 3.3.0</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">lubridate</span> 1.9.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr    </span> 1.3.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr    </span> 1.1.0     </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use the conflicted package (<span style="color: #0000BB; font-style: italic;">&lt;http://conflicted.r-lib.org/&gt;</span>) to force all conflicts to become errors</span></span></code></pre></div>
<p>Alternatively, individual packages can be loaded independently:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span></code></pre></div>
<p>Additionally in this vignette, we will cover options to use the
continuous cycle time measures generated by <code>menstrualcycleR</code>
in nonlinear multilevel analyses using the <code>mgcv</code>,
<code>gam.hp</code>, and <code>marginaleffects</code> packages. You can
install and load these packages by running:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"mgcv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"gam.hp"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"marginaleffects"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mgcv</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: nlme</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'nlme'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     collapse</span></span>
<span><span class="co">#&gt; This is mgcv 1.9-1. For overview type 'help("mgcv-package")'.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/laijiangshan/gam.hp" class="external-link">gam.hp</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Thank you for using this package! If you use this package in your research, please cite the following references</span></span>
<span><span class="co">#&gt; Jiangshan Lai, Jing Tang, Tingyuan Li, Aiying Zhan, Lingfeng Mao. 2024. Evaluating the relative importance of predictors in Generalized Additive Models using the gam.hp R package. Plant Diversity, 46(4): 542-546</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://marginaleffects.com/" class="external-link">marginaleffects</a></span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
<div class="section level2">
<h2 id="using-menstrualcycler">Using <code>menstrualcycleR</code><a class="anchor" aria-label="anchor" href="#using-menstrualcycler"></a>
</h2>
<div class="section level3">
<h3 id="overview-of-package-functions">Overview of Package Functions<a class="anchor" aria-label="anchor" href="#overview-of-package-functions"></a>
</h3>
<p>The <code>menstrualcycleR</code> package contains four main
categories of functions:</p>
<hr>
<div class="section level4">
<h4 id="cycle-scaling-function-pacts_scaling">1. Cycle Scaling Function: <code>pacts_scaling()</code><a class="anchor" aria-label="anchor" href="#cycle-scaling-function-pacts_scaling"></a>
</h4>
<p>This function adds standardized cycle time variables to your
dataset.</p>
<ul>
<li><p><code>scaled_cycleday</code>:<br>
A continuous cycle time variable centered on <strong>menses
onset</strong> (<code>menses == 1 → 0</code>), ranging from –1 (start of
luteal phase) to +1 (ovulation). This maps -1 and +1 as adjacent days.
This is what the supplementary analyses of Nagpal et al. (2025) include.
Includes <strong>only biomarker-confirmed</strong> ovulation
cycles.</p></li>
<li><p><code>scaled_cycleday_impute</code>:<br>
Same as above, but also includes cycles with <strong>imputed
ovulation</strong> (assigned to day –15 before next menses). Increases
dataset coverage, but with lower precision. This maps -1 and +1 as
adjacent days. This is what the supplementary analyses of Nagpal et
al. (2025) include.</p></li>
<li><p><code>scaled_cycleday_ov</code>:<br>
A cycle time variable centered on <strong>ovulation</strong>
(<code>ovtoday == 1 → 0</code>), ranging from –1 (start of follicular
phase) to +1 (end of luteal phase). Biomarker-confirmed ovulation only.
This maps -1 and +1 as adjacent days. This is what the supplementary
analyses of Nagpal et al. (2025) include.</p></li>
<li><p><code>scaled_cycleday_imp_ov</code>:<br>
Same as above, but includes <strong>imputed ovulation</strong>
(<code>ovtoday_impute == 1</code>) for cycles lacking confirmation.
Centered on either confirmed or imputed ovulation. This maps -1 and +1
as adjacent days. This is what the supplementary analyses of Nagpal et
al. (2025) include.</p></li>
<li><p><code>cyclic_time</code>:<br>
A continuous cycle time variable centered on <strong>menses
onset</strong> (<code>menses == 1 → 0</code>), ranging from –1 (start of
luteal phase) to +1 (ovulation). Includes <strong>only
biomarker-confirmed</strong> ovulation cycles. This ensures that -1 and
+1 are hormonally equivalent, rather than adjacent. This is what the
main analyses of Nagpal et al. (2025) include. Other iterations of cycle
time (<code>scaled_cycleday</code>) are being phased out.</p></li>
<li><p><code>cyclic_time_impute</code>:<br>
Same as above, but also includes cycles with <strong>imputed
ovulation</strong> (assigned to day –15 before next menses). Increases
dataset coverage, but with lower precision. This ensures that -1 and +1
are hormonally equivalent, rather than adjacent. This is what the main
analyses of Nagpal et al. (2025) include. Other iterations of cycle time
(<code>scaled_cycleday</code>) are being phased out.</p></li>
<li><p><code>cyclic_time_ov</code>:<br>
A cycle time variable centered on <strong>ovulation</strong>
(<code>ovtoday == 1 → 0</code>), ranging from –1 (start of follicular
phase) to +1 (end of luteal phase). Biomarker-confirmed ovulation only.
This ensures that -1 and +1 are hormonally equivalent, rather than
adjacent. This is what the main analyses of Nagpal et al. (2025)
include. Other iterations of cycle time (<code>scaled_cycleday</code>)
are being phased out.</p></li>
<li><p><code>cyclic_time_imp_ov</code>:<br>
Same as above, but includes <strong>imputed ovulation</strong>
(<code>ovtoday_impute == 1</code>) for cycles lacking confirmation.
Centered on either confirmed or imputed ovulation. This ensures that -1
and +1 are hormonally equivalent, rather than adjacent. This is what the
main analyses of Nagpal et al. (2025) include. Other iterations of cycle
time (<code>scaled_cycleday</code>) are being phased out.</p></li>
<li><p><code>ovtoday_impute</code>:<br>
A binary indicator identifying <strong>imputed ovulation days</strong>
(value = 1), estimated as 15 days before the next menses onset.</p></li>
</ul>
<hr>
</div>
<div class="section level4">
<h4 id="data-checking-functions">2. Data Checking Functions<a class="anchor" aria-label="anchor" href="#data-checking-functions"></a>
</h4>
<p>These functions assess the <strong>completeness and coverage</strong>
of your dataset:</p>
<ul>
<li><p><code><a href="../reference/cycledata_check.html">cycledata_check()</a></code>:<br>
Summarizes non-missing data by cycle phase (follicular, luteal) and
overall. Also produces <strong>visualizations</strong> by participant
and cycle phase.</p></li>
<li>
<p><code><a href="../reference/summary_ovulation.html">summary_ovulation()</a></code>:<br>
Reports ovulation detection status:</p>
<ul>
<li>How many cycles had <strong>biomarker-confirmed</strong>
ovulation</li>
<li>How many cycles required <strong>imputed ovulation</strong> using
the day –15 rule (<code>ovtoday_impute == 1</code>), based on standard
luteal phase length</li>
</ul>
</li>
</ul>
<hr>
</div>
<div class="section level4">
<h4 id="data-visualization-functions">3. Data Visualization Functions<a class="anchor" aria-label="anchor" href="#data-visualization-functions"></a>
</h4>
<p>Use these functions to <strong>plot outcomes across the menstrual
cycle</strong>:</p>
<ul>
<li><p><code><a href="../reference/cycle_plot.html">cycle_plot()</a></code>:<br>
Creates a <strong>sample-level plot</strong> of symptom or outcome
trajectories across the standardized cycle. Supports centering on either
<strong>menses</strong> or <strong>ovulation</strong>, with flexible
y-axis scaling.</p></li>
<li><p><code><a href="../reference/cycle_plot_individual.html">cycle_plot_individual()</a></code>:<br>
Provides <strong>participant-level plots</strong> across cycles for
selected symptoms. Useful for individual inspection or diagnostic
review.</p></li>
</ul>
<p>Both functions: - Calculate per-cycle means and deviations - Allow
centering on menses or ovulation - Are compatible with scaled time
variables</p>
<hr>
</div>
<div class="section level4">
<h4 id="launching-the-shiny-app-launch_app">4. Launching the Shiny App: <code>launch_app()</code><a class="anchor" aria-label="anchor" href="#launching-the-shiny-app-launch_app"></a>
</h4>
<p>This function launches an interactive Shiny application for
uploading, checking, and analyzing menstrual cycle data using the
package functions.</p>
<p>The app includes tools for: - Scaled cycle time computation - Data
completeness checks - Visualization by person and symptom - PMDD, MRMD,
and PME diagnosis using the <strong>Carolina Premenstrual Assessment
Scoring System (C-PASS)</strong> - Please note that cycles utilized for
diagnosis in the CPASS are defined by counting days forward (+10) and
backward (-7) from menses onset.</p>
<blockquote>
<p>C-PASS is implemented via the <a href="https://lasy.github.io/cpass/" class="external-link"><code>cpass</code></a> R package.
Please cite this package if you utilize the CPASS tool in the shiny
app:<br>
Symul L, Eisenlohr-Moul T (2025). <em>cpass: PMDD and MRMD Diagnoses
Following The Carolina Premenstrual Assessment Scoring System
(C-PASS)</em>. R package version 0.1.0.</p>
</blockquote>
<blockquote>
<p>For more on C-PASS as a diagnostic tool, see:<br>
Eisenlohr-Moul, T. A., Girdler, S. S., Schmalenberger, K. M., Dawson, D.
N., Surana, P., Johnson, J. L., &amp; Rubinow, D. R. (2017).<br><em>Toward the Reliable Diagnosis of DSM-5 Premenstrual Dysphoric
Disorder: The Carolina Premenstrual Assessment Scoring System
(C-PASS).</em><br>
American Journal of Psychiatry, 174(1), 51–59. <a href="https://doi.org/10.1176/appi.ajp.2016.15121510" class="external-link uri">https://doi.org/10.1176/appi.ajp.2016.15121510</a>
<strong>Please cite this paper if you utilize the CPASS tool in the
shiny app.</strong></p>
</blockquote>
<blockquote>
<p><strong>The shiny app is also accessible online here:</strong><br>
👉 <a href="https://menstrualcycledata.shinyapps.io/shiny/" class="external-link uri">https://menstrualcycledata.shinyapps.io/shiny/</a></p>
</blockquote>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="demo-dataset">Demo dataset<a class="anchor" aria-label="anchor" href="#demo-dataset"></a>
</h3>
<p>To explore the <code>menstrualcycleR</code> package, we will use a
demo dataset with simulated daily ratings (labeled as
<code>symptom</code>) from 25 participants with menses onset and
ovulation information. This data is simulated and is not representative
of any particular outcome you may study across the cycle. The variable
<code>menses</code> has a 1 when indicating first day of menstruation or
menses onset. The variable <code>ovtoday</code> has a 1 when indicating
the day after a positive luteinizing-hormone test, estimating the day of
ovulation.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cycle_df</span> <span class="op">=</span> <span class="va">cycledata</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">cycle_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 619   5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cycle_df</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id menses ovtoday symptom  daterated</span></span>
<span><span class="co">#&gt; 1  1      1       0       5 2024-01-20</span></span>
<span><span class="co">#&gt; 2  1      0       0       5 2024-01-21</span></span>
<span><span class="co">#&gt; 3  1      0       0       3 2024-01-22</span></span>
<span><span class="co">#&gt; 4  1      0       0       2 2024-01-24</span></span>
<span><span class="co">#&gt; 5  1      0       0       1 2024-01-25</span></span>
<span><span class="co">#&gt; 6  1      0       0       1 2024-01-26</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="applying-pacts">Applying PACTS<a class="anchor" aria-label="anchor" href="#applying-pacts"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cycle_df_scaled</span> <span class="op">=</span> <span class="fu"><a href="../reference/pacts_scaling.html">pacts_scaling</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cycle_df</span>, id <span class="op">=</span> <span class="va">id</span>, date <span class="op">=</span> <span class="va">daterated</span>, menses <span class="op">=</span> <span class="va">menses</span>, ovtoday <span class="op">=</span> <span class="va">ovtoday</span>, lower_cyclength_bound <span class="op">=</span> <span class="fl">21</span>, upper_cyclength_bound <span class="op">=</span> <span class="fl">35</span><span class="op">)</span></span>
<span><span class="co">#&gt; id: id</span></span>
<span><span class="co">#&gt; date: date</span></span>
<span><span class="co">#&gt; menses: menses</span></span>
<span><span class="co">#&gt; ovtoday: ovtoday</span></span></code></pre></div>
<p>For full documentation, type <code>?pacts_scaling()</code> in R
console. The lower and upper cycle length bounds may be adjusted, but
the default is 21-35 days as that was what was validated in Nagpal et
al., (2025). Only cycles between 21 and 35 days will get scaled, or if a
luteal phase with confirmed ovulation and menses onset is between 7-18
days.</p>
<p><code>cycle_df_scaled</code> will now have additional variables as
well as observations. In this dataset we went from initially having 614
observations in <code>cycle_df</code> and then having 739 observations
in <code>cycle_df_scaled</code>. When scaling the cycle using
<code><a href="../reference/pacts_scaling.html">pacts_scaling()</a></code>, each cycle is required to have a complete
sequence of calendar days from menses onset to the next menses onset. If
a participant missed reporting symptoms on any day within a cycle, the
function inserts placeholder rows with <code>NA</code> values to ensure
continuity. This process allows accurate computation of cycle-aligned
time variables.</p>
<div class="section level4">
<h4 id="before-and-after-filling-missing-dates-within-a-cycle">Before and After: Filling Missing Dates Within a Cycle<a class="anchor" aria-label="anchor" href="#before-and-after-filling-missing-dates-within-a-cycle"></a>
</h4>
<p>Below is an example showing how <code><a href="../reference/pacts_scaling.html">pacts_scaling()</a></code> fills in
rows for missing dates in a real participant’s cycle.</p>
<p><strong>Original data (<code>cycle_df</code>)</strong></p>
<table class="table">
<thead><tr class="header">
<th>id</th>
<th>menses</th>
<th>ovtoday</th>
<th>symptom</th>
<th>daterated</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>0</td>
<td>5</td>
<td>2024-01-20</td>
</tr>
<tr class="even">
<td>1</td>
<td>0</td>
<td>0</td>
<td>4</td>
<td>2024-01-21</td>
</tr>
<tr class="odd">
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>2024-01-22</td>
</tr>
<tr class="even">
<td>1</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>2024-01-24</td>
</tr>
<tr class="odd">
<td>1</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>2024-01-25</td>
</tr>
<tr class="even">
<td>1</td>
<td>0</td>
<td>0</td>
<td>5</td>
<td>2024-01-26</td>
</tr>
</tbody>
</table>
<ul>
<li>This participant <strong>skipped reporting on
2024-01-23</strong>.</li>
<li>The time series is incomplete for cycle scaling until the gap is
filled.</li>
</ul>
<p><strong>After scaling (<code>cycle_df_scaled</code>)</strong></p>
<table class="table">
<thead><tr class="header">
<th>id</th>
<th>menses</th>
<th>ovtoday</th>
<th>symptom</th>
<th>daterated</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>0</td>
<td>5</td>
<td>2024-01-20</td>
</tr>
<tr class="even">
<td>1</td>
<td>0</td>
<td>0</td>
<td>4</td>
<td>2024-01-21</td>
</tr>
<tr class="odd">
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>2024-01-22</td>
</tr>
<tr class="even">
<td>1</td>
<td>0</td>
<td>0</td>
<td>NA</td>
<td>2024-01-23</td>
</tr>
<tr class="odd">
<td>1</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>2024-01-24</td>
</tr>
<tr class="even">
<td>1</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>2024-01-25</td>
</tr>
<tr class="odd">
<td>1</td>
<td>0</td>
<td>0</td>
<td>5</td>
<td>2024-01-26</td>
</tr>
</tbody>
</table>
<ul>
<li>The function inserts a placeholder row for 2024-01-23 with
<code>NA</code> in the <code>symptom</code> column.</li>
<li>This ensures complete daily continuity from menses to the end of the
cycle.</li>
</ul>
<hr>
</div>
<div class="section level4">
<h4 id="summary-of-row-counts">Summary of Row Counts<a class="anchor" aria-label="anchor" href="#summary-of-row-counts"></a>
</h4>
<table class="table">
<colgroup>
<col width="24%">
<col width="17%">
<col width="57%">
</colgroup>
<thead><tr class="header">
<th>Dataset</th>
<th>Observations</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>cycle_df</code></td>
<td>619</td>
<td>Original data; only dates with reports</td>
</tr>
<tr class="even">
<td><code>cycle_df_scaled</code></td>
<td>744</td>
<td>Additional rows added to fill date gaps</td>
</tr>
</tbody>
</table>
<p>By ensuring complete daily coverage, <code><a href="../reference/pacts_scaling.html">pacts_scaling()</a></code>
allows downstream modeling and visualization tools to interpret
menstrual cycle time as a continuous, standardized variable across
individuals and cycles.</p>
<hr>
</div>
<div class="section level4">
<h4 id="cycle-time-variables-are-added-in-cycle_df_scaled">Cycle time variables are added in cycle_df_scaled<a class="anchor" aria-label="anchor" href="#cycle-time-variables-are-added-in-cycle_df_scaled"></a>
</h4>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cycle_df_scaled</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "id"                     "date"                   "menses"                </span></span>
<span><span class="co">#&gt;  [4] "ovtoday"                "symptom"                "daterated"             </span></span>
<span><span class="co">#&gt;  [7] "m2mcount"               "mcyclength"             "cycle_incomplete"      </span></span>
<span><span class="co">#&gt; [10] "cyclenum"               "ovtoday_impute"         "scaled_cycleday"       </span></span>
<span><span class="co">#&gt; [13] "scaled_cycleday_ov"     "scaled_cycleday_impute" "scaled_cycleday_imp_ov"</span></span>
<span><span class="co">#&gt; [16] "cyclic_time"            "cyclic_time_impute"     "cyclic_time_ov"        </span></span>
<span><span class="co">#&gt; [19] "cyclic_time_imp_ov"     "luteal_length"</span></span></code></pre></div>
<ul>
<li><p><code>scaled_cycleday</code>:<br>
A continuous cycle time variable centered on <strong>menses
onset</strong> (<code>menses == 1 → 0</code>), ranging from –1 (start of
luteal phase) to +1 (ovulation). Includes <strong>only
biomarker-confirmed</strong> ovulation cycles.</p></li>
<li><p><code>scaled_cycleday_impute</code>:<br>
Same as above, but also includes cycles with <strong>imputed
ovulation</strong> (assigned to day –15 before next menses). Increases
dataset coverage, but with lower precision.</p></li>
<li><p><code>scaled_cycleday_ov</code>:<br>
A cycle time variable centered on <strong>ovulation</strong>
(<code>ovtoday == 1 → 0</code>), ranging from –1 (start of follicular
phase) to +1 (end of luteal phase). Biomarker-confirmed ovulation
only.</p></li>
<li><p><code>scaled_cycleday_imp_ov</code>:<br>
Same as above, but includes <strong>imputed ovulation</strong>
(<code>ovtoday_impute == 1</code>) for cycles lacking confirmation.
Centered on either confirmed or imputed ovulation.</p></li>
<li><p><code>ovtoday_impute</code>:<br>
A binary indicator identifying <strong>imputed ovulation days</strong>
(value = 1), estimated as 15 days before the next menses onset.</p></li>
<li><p><code>mcyclength</code>: Indicates the length of a
menses-to-menses cycle an observation belongs to.</p></li>
<li><p><code>luteal_length</code>: Indicates the length of the luteal
phase an observation belongs to, when ovulation was not imputed. This is
computed only for cycles that meet the criteria to be scaled.</p></li>
<li><p><code>cycle_inomplete</code> A binary indicator identifying if
the observation is part of an incomplete menses-to-menses cycle</p></li>
<li><p><code>cyclic_time</code> A continuous cycle time variable
centered on <strong>menses onset</strong>
(<code>menses == 1 → 0</code>), ranging from –1 to +1. Unlike
<code>scaled_cycleday</code>, -1 and + 1 are parameterized to have the
same hormonal meaning of <strong>ovulation</strong>. Includes
<strong>only biomarker-confirmed</strong> ovulation cycles.</p></li>
<li><p><code>cyclic_time_impute</code> Same as above, but also includes
cycles with <strong>imputed ovulation</strong> (assigned to day –15
before next menses). Increases dataset coverage, but with lower
precision.</p></li>
<li><p><code>cyclic_time_ov</code> A cycle time variable centered on
<strong>ovulation</strong> (<code>ovtoday == 1 → 0</code>), ranging from
–1 to +1. Unlike <code>scaled_cycleday_ov</code>, -1 and + 1 are
parameterized to have the same hormonal meaning of
<strong>menses_onset</strong>. Includes <strong>only
biomarker-confirmed</strong> ovulation.</p></li>
<li><p><code>cyclic_time_imp_ov</code> Same as above, but includes
<strong>imputed ovulation</strong> (<code>ovtoday_impute == 1</code>)
for cycles lacking confirmation. Centered on either confirmed or imputed
ovulation.</p></li>
</ul>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="checking-data-availability">Checking Data availability<a class="anchor" aria-label="anchor" href="#checking-data-availability"></a>
</h3>
<p>To examine how much non-missing data is available, apply
<code><a href="../reference/cycledata_check.html">cycledata_check()</a></code>, inputting our resultant dataset from
above (<code>df_with_scaling</code>) and choosing which outcomes you
would like to look at. As of now, this function examines number of
observations with a corresponding value for
<code>scaled_cycleday_impute</code>. Here we are examining only 1
outcome: <code>symptom</code>. However, if you would like to look at
more outcomes at once, replace <code>c("symptom")</code> with the
outcomes of interest:
e.g.<code>c("symptom1", "symptom2", "symptom3")</code></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">checkdata</span> <span class="op">=</span> <span class="fu"><a href="../reference/cycledata_check.html">cycledata_check</a></span><span class="op">(</span><span class="va">cycle_df_scaled</span>, symptom_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"symptom"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: ID number 8 has &lt; 10 observations for symptom</span></span></code></pre></div>
<p>This function will output a warning if any IDs have less than 10
observations in a menses-to-menses cycle for the outcome selected.</p>
<p>We can examine how much non-missing data for <code>symptom</code>
each ID has with a corresponding scaled cycle time measure (taking into
account imputed ovulation) both overall, and by phase (luteal and
follicular).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">checkdata</span><span class="op">$</span><span class="va">by_id</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 25 × 4</span></span></span>
<span><span class="co">#&gt;       id symptom_nonNA symptom_luteal symptom_follicular</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1            20             10                 10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2            22             12                 10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3            26             13                 13</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4            26             11                 15</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     5            18              6                 12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     6            31             12                 19</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     7            20              6                 14</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     8             9              0                  9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     9            29             13                 16</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    10            28             11                 17</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 15 more rows</span></span></span></code></pre></div>
<p>We can also examine this in aggregate, looking at the sample as a
whole:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">checkdata</span><span class="op">$</span><span class="va">overall</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">#&gt;   symptom_nonNA symptom_luteal symptom_follicular</span></span>
<span><span class="co">#&gt;           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>           575            218                357</span></span></code></pre></div>
<p>Overall, 574 observations with non-NA or non-missing values for
<code>symptom</code> were scaled because they existed in
menses-to-menses cycles between 21 and 35 days and associated luteal
phases (for cycles that had a reported value for <code>ovtoday</code>)
were between 7-18 days. We can also visualize non-missing symptom data
across the cycle:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">checkdata</span><span class="op">$</span><span class="va">data_symptom_plots</span></span>
<span><span class="co">#&gt; $symptom</span></span></code></pre></div>
<p><img src="menstrualcycleR-overview_files/figure-html/cycledata_check_plot%20-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="checking-ovulation-data-availability">Checking Ovulation Data Availability<a class="anchor" aria-label="anchor" href="#checking-ovulation-data-availability"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ov_summary</span> <span class="op">=</span> <span class="fu"><a href="../reference/summary_ovulation.html">summary_ovulation</a></span><span class="op">(</span><span class="va">cycle_df_scaled</span><span class="op">)</span></span></code></pre></div>
<p>This function will help you evaluate how many cycles had a confirmed
ovulation value prior to using <code>menstrualcycleR</code> and how many
cycles had an ovulation day imputed via 15-day backward count via the
<code><a href="../reference/pacts_scaling.html">pacts_scaling()</a></code> function. (see <a href="#estimating-ovulation-when-biomarkers-are-unavailable">Estimating
Ovulation When Biomarkers Are Unavailable</a> and <a href="#ovulation-assessment-or-imputation">Ovulation Assessment or
Imputation</a>).</p>
<p>We can examine this across the entire sample:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ov_summary</span><span class="op">$</span><span class="va">ovstatus_total</span></span>
<span><span class="co">#&gt;          Total Confirmed Ovulation</span></span>
<span><span class="co">#&gt; N cycles                        14</span></span>
<span><span class="co">#&gt;          Total Estimated Ovulation via 15day Backward Count</span></span>
<span><span class="co">#&gt; N cycles                                                 11</span></span></code></pre></div>
<p>And also by each id in the dataset:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ov_summary</span><span class="op">$</span><span class="va">ovstatus_id</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 25 × 3</span></span></span>
<span><span class="co">#&gt;       id `Total cycles with confirmed ovulation` Total cycles with imputed ovu…¹</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>                                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1                                       0                               1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2                                       1                               0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3                                       1                               0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4                                       0                               1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     5                                       1                               0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     6                                       0                               1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     7                                       1                               0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     8                                       1                               0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     9                                       0                               1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    10                                       1                               0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 15 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ abbreviated name:</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ¹​`Total cycles with imputed ovulation via 15day Backward Count`</span></span></span></code></pre></div>
<p>Researchers are strongly encouraged to report the proportion of
confirmed versus imputed ovulation days for transparency and scientific
rigor.</p>
</div>
<div class="section level3">
<h3 id="visualizing-outcomes-across-the-cycle">Visualizing outcomes across the cycle<a class="anchor" aria-label="anchor" href="#visualizing-outcomes-across-the-cycle"></a>
</h3>
<div class="section level4">
<h4 id="cycle_plot">
<code>cycle_plot()</code><a class="anchor" aria-label="anchor" href="#cycle_plot"></a>
</h4>
<p>The <code><a href="../reference/cycle_plot.html">cycle_plot()</a></code> function generates a group-level
visualization of symptom or outcome data across the standardized
menstrual cycle. This function supports flexible centering (on menses or
ovulation), person-centered or raw scaling, and optional smoothing via
rolling averages. Rolling averages are supported by the package
<code>zoo</code>.</p>
<p>Let’s take a look at the parameters of <code>cycle_plot</code>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cycle_plot.html">cycle_plot</a></span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">symptom</span>,</span>
<span>  centering <span class="op">=</span> <span class="st">"menses"</span>,</span>
<span>  include_impute <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  y_scale <span class="op">=</span> <span class="st">"person-centered_roll"</span>,</span>
<span>  rollingavg <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  align_val <span class="op">=</span> <span class="st">"center"</span>,</span>
<span>  se <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<ul>
<li><p><code>data</code>:<br>
A dataframe containing the cycle-aligned data. Must include the relevant
scaled cycle time variables (<code>scaled_cycleday</code>,
<code>scaled_cycleday_ov</code>, <code>cyclic_time</code>, etc.) and the
symptom column. This function will only work if your dataset has been
run through <code><a href="../reference/pacts_scaling.html">pacts_scaling()</a></code> first.</p></li>
<li><p><code>symptom</code>:<br>
A string specifying the name of the symptom or outcome variable to
visualize.</p></li>
<li><p><code>centering</code>:<br>
Whether to center the x-axis on <code>"menses"</code> (default) or
<code>"ovulation"</code>. This determines which scaled cycle day
variable is used.</p></li>
<li><p><code>include_impute</code>:<br>
Logical. If <code>TRUE</code>, uses both confirmed and imputed ovulation
cycles. Set to <code>FALSE</code> to restrict the analysis to
biomarker-confirmed cycles only.</p></li>
<li>
<p><code>y_scale</code>:<br>
Specifies how to scale the y-axis:</p>
<ul>
<li>
<code>"person-centered"</code>: Mean person-centered values</li>
<li>
<code>"person-centered_roll"</code>: Smoothed person-centered values
(default) that applies a rolling average to data, using
<code><a href="https://rdrr.io/pkg/zoo/man/rollapply.html" class="external-link">zoo::rollapply</a></code>
</li>
<li>
<code>"means"</code>: Raw mean values of participants</li>
</ul>
</li>
<li><p><code>rollingavg</code>:<br>
Number of days used for rolling average smoothing (default = 5).
Computed using <code>zoo::rollapply.</code></p></li>
<li><p><code>align_val</code>:<br>
Controls alignment of the rolling average window (<code>"center"</code>,
<code>"left"</code>, or <code>"right"</code>). Passed to
<code><a href="https://rdrr.io/pkg/zoo/man/rollapply.html" class="external-link">zoo::rollapply</a></code>.</p></li>
<li><p><code>se</code>:<br>
Logical. If <code>TRUE</code>, includes a standard error ribbon around
the group mean.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="note-on-rolling-averages">Note on Rolling Averages<a class="anchor" aria-label="anchor" href="#note-on-rolling-averages"></a>
</h4>
<p>If <code>y_scale = "person-centered_roll"</code> is selected, rolling
averages are calculated using the <code><a href="https://rdrr.io/pkg/zoo/man/rollapply.html" class="external-link">zoo::rollapply()</a></code>
function, which applies a moving average over the time series, with the
settings as:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">zoo</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/zoo/man/rollapply.html" class="external-link">rollapply</a></span><span class="op">(</span></span>
<span>  <span class="va">variable</span>,         <span class="co"># vector of values</span></span>
<span>  <span class="va">rollingavg</span>,       <span class="co"># size of the moving window (default = 5 days)</span></span>
<span>  FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="co"># specifies a mean function to apply to each rolling window of values, ignoring missing values</span></span>
<span>  align <span class="op">=</span> <span class="st">"center"</span>, <span class="co"># align the output to the center of the window</span></span>
<span>  fill <span class="op">=</span> <span class="cn">NA</span>,        <span class="co"># fill edges with NA where full window is not available</span></span>
<span>  partial <span class="op">=</span> <span class="cn">TRUE</span>    <span class="co"># allow smaller windows at the beginning and end</span></span>
<span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p>If you use the <code>"person_centered_roll"</code> option for the
<code>y_scale</code>, please cite the <code>zoo</code> package:<br>
Zeileis A, Grothendieck G (2005). “zoo: S3 Infrastructure for Regular
and Irregular Time Series.”<br><em>Journal of Statistical Software</em>, <em>14</em>(6), 1–27.<br><a href="https://doi.org/10.18637/jss.v014.i06" class="external-link">https://doi.org/10.18637/jss.v014.i06</a></p>
</blockquote>
<hr>
</div>
<div class="section level4">
<h4 id="symptom-menses-centered">Symptom, Menses-centered<a class="anchor" aria-label="anchor" href="#symptom-menses-centered"></a>
</h4>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cycle_plot_df_menses</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cycle_plot.html">cycle_plot</a></span><span class="op">(</span></span>
<span>  <span class="va">cycle_df_scaled</span>,</span>
<span>  <span class="st">"symptom"</span>,</span>
<span>  centering <span class="op">=</span> <span class="st">"menses"</span>,</span>
<span>  include_impute <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  y_scale <span class="op">=</span> <span class="st">"person-centered_roll"</span>, </span>
<span>  se <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><code><a href="../reference/cycle_plot.html">cycle_plot()</a></code> returns a list with three components:</p>
<ol style="list-style-type: decimal">
<li>
<strong>data</strong>: The original data augmented with person-mean
(<code>.m</code>) and deviation (<code>.d</code>) values for the
symptom.</li>
</ol>
<p>A “person-mean” is the average of all of a single participant’s
repeated scores or measurements over time. It represents a way to
summarize what is “typical” for a given person, and is used for
“between-person” or “trait-level” analyses.</p>
<p>• By extension, “deviations from person-mean” represent the
differences between a person’s score on a specific day (or other
repeated measure interval) and their usual average (their person-mean).
It tells us how much higher or lower they are compared to their normal,
and is used in “within-person” or “state-level” analyses.</p>
<ol start="2" style="list-style-type: decimal">
<li><p><strong>summary</strong>: A summary of the outcome variable at
each 5% increment of the scaled cycle timeline.It also provides standard
errors if <code>se = T</code> is included in the function
parameters.</p></li>
<li><p><strong>plot</strong>: A <code>ggplot2</code> object visualizing
the trajectory of the symptom variable across the cycle.</p></li>
</ol>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cycle_plot_df_menses</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 744 × 25</span></span></span>
<span><span class="co">#&gt;       id date       menses ovtoday symptom daterated  m2mcount mcyclength</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1 2024-01-20      1       0       5 2024-01-20        1         24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1 2024-01-21      0       0       5 2024-01-21        2         24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     1 2024-01-22      0       0       3 2024-01-22        3         24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1 2024-01-23      0       0      <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>                4         24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     1 2024-01-24      0       0       2 2024-01-24        5         24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     1 2024-01-25      0       0       1 2024-01-25        6         24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     1 2024-01-26      0       0       1 2024-01-26        7         24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     1 2024-01-27      0       0       1 2024-01-27        8         24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     1 2024-01-28      0       0       3 2024-01-28        9         24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     1 2024-01-29      0       0       4 2024-01-29       10         24</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 734 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 17 more variables: cycle_incomplete &lt;dbl&gt;, cyclenum &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ovtoday_impute &lt;int&gt;, scaled_cycleday &lt;dbl&gt;, scaled_cycleday_ov &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   scaled_cycleday_impute &lt;dbl&gt;, scaled_cycleday_imp_ov &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   cyclic_time &lt;dbl&gt;, cyclic_time_impute &lt;dbl&gt;, cyclic_time_ov &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   cyclic_time_imp_ov &lt;dbl&gt;, luteal_length &lt;dbl&gt;, symptom.m &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   symptom.d &lt;dbl&gt;, symptom.d.roll &lt;dbl&gt;, cycleday_perc &lt;dbl&gt;, …</span></span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cycle_plot_df_menses</span><span class="op">$</span><span class="va">summary</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 22 × 3</span></span></span>
<span><span class="co">#&gt;    cycleday_5perc mean_dev_roll     se</span></span>
<span><span class="co">#&gt;             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>           0          1.03    0.178 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>           0.05       0.677   0.125 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>           0.1        0.024<span style="text-decoration: underline;">8</span>  0.182 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>           0.15      -<span style="color: #BB0000;">0.398</span>   0.198 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>           0.2       -<span style="color: #BB0000;">0.907</span>   0.132 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>           0.25      -<span style="color: #BB0000;">1.13</span>    0.109 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>           0.3       -<span style="color: #BB0000;">1.14</span>    0.070<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>           0.35      -<span style="color: #BB0000;">0.663</span>   0.107 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>           0.4       -<span style="color: #BB0000;">0.005</span><span style="color: #BB0000; text-decoration: underline;">51</span> 0.146 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>           0.45       0.613   0.122 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 12 more rows</span></span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cycle_plot_df_menses</span><span class="op">$</span><span class="va">plot</span></span>
<span><span class="co">#&gt; Warning: Removed 1 row containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_line()`).</span></span></code></pre></div>
<p><img src="menstrualcycleR-overview_files/figure-html/cycle_plot_menses_raw_plot-1.png" width="672"></p>
<p>This plot is a ggplot object and can be edited using the package
<code>ggplot2</code> and saved using the function
<code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave()</a></code>.</p>
</div>
<div class="section level4">
<h4 id="symptom-ovulation-centered">Symptom, Ovulation-centered<a class="anchor" aria-label="anchor" href="#symptom-ovulation-centered"></a>
</h4>
<p>Here is the same data, centered on ovulation.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cycle_plot_df_ov</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cycle_plot.html">cycle_plot</a></span><span class="op">(</span></span>
<span>  <span class="va">cycle_df_scaled</span>,</span>
<span>  <span class="st">"symptom"</span>,</span>
<span>  centering <span class="op">=</span> <span class="st">"ovulation"</span>,</span>
<span>  include_impute <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  y_scale <span class="op">=</span> <span class="st">"person-centered_roll"</span>, </span>
<span>  se <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cycle_plot_df_ov</span><span class="op">$</span><span class="va">plot</span></span>
<span><span class="co">#&gt; Warning: Removed 1 row containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_line()`).</span></span></code></pre></div>
<p><img src="menstrualcycleR-overview_files/figure-html/cycle_plot_ov_roll_plot_access-1.png" width="672"></p>
</div>
</div>
<div class="section level3">
<h3 id="visualizing-individual-participants-and-cycles-with-cycle_plot_individual">Visualizing Individual Participants and Cycles with
<code>cycle_plot_individual()</code><a class="anchor" aria-label="anchor" href="#visualizing-individual-participants-and-cycles-with-cycle_plot_individual"></a>
</h3>
<div class="section level4">
<h4 id="cycle_plot_individual">
<code>cycle_plot_individual</code><a class="anchor" aria-label="anchor" href="#cycle_plot_individual"></a>
</h4>
<p>The <code><a href="../reference/cycle_plot_individual.html">cycle_plot_individual()</a></code> function generates
<strong>cycle-specific plots and summaries</strong> for a given
participant ID. This function is especially useful for quality control,
or individualized data visualization. It produces one plot per cycle,
centered on either menses or ovulation, and includes summary data for
each. Rolling averages are supported by the package
<code>zoo</code>.</p>
<p>Let’s take a look at the parameters of
<code>cycle_plot_individual</code>:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cycle_plot_individual.html">cycle_plot_individual</a></span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">id</span>,</span>
<span>  <span class="va">symptoms</span>,</span>
<span>  centering <span class="op">=</span> <span class="st">"menses"</span>,</span>
<span>  y_scale <span class="op">=</span> <span class="st">"person-centered"</span>,</span>
<span>  include_impute <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  rollingavg <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span></code></pre></div>
<ul>
<li><p><code>data</code>:<br>
A dataframe containing scaled cycle data with at least <code>id</code>,
<code>cyclenum</code>, and the relevant symptom variables. The dataframe
must already include the appropriate scaled cycle time columns.</p></li>
<li><p><code>id</code>:<br>
A numeric or character value specifying the participant ID to
visualize.</p></li>
<li><p><code>symptoms</code>:<br>
A character vector of one or more symptom variables to plot.</p></li>
<li><p><code>centering</code>:<br>
Center the plot on <code>"menses"</code> (default) or
<code>"ovulation"</code>. Determines which scaled time variable is
used.</p></li>
<li>
<p><code>y_scale</code>:<br>
Specifies the type of y-axis transformation:</p>
<ul>
<li>
<code>"person-centered"</code>: Deviation from participant mean</li>
<li>
<code>"person-centered_roll"</code>: Smoothed person-centered values
(default) that applies a rolling average to data, using
<code><a href="https://rdrr.io/pkg/zoo/man/rollapply.html" class="external-link">zoo::rollapply</a></code>
</li>
<li>
<code>"raw"</code>: Uncentered raw values</li>
<li>
<code>"roll"</code>: Rolling average of raw values</li>
</ul>
</li>
<li><p><code>include_impute</code>:<br>
Logical. If <code>TRUE</code>, includes cycles with imputed
ovulation.</p></li>
<li>
<p><code>rollingavg</code>:<br>
Number of days to use in the rolling average window (default = 5).
Applies only when using <code>"roll"</code> or
<code>"person-centered_roll"</code> scales. Computed using
<code>zoo::rollapply.</code></p>
<blockquote>
<p><strong>Note:</strong> If you use the
<code>"person_centered_roll"</code> or <code>"roll"</code> option for
the <code>y_scale</code>, please cite the <code>zoo</code>
package:<br>
Zeileis A, Grothendieck G (2005). “zoo: S3 Infrastructure for Regular
and Irregular Time Series.”<br><em>Journal of Statistical Software</em>, <em>14</em>(6), 1–27.<br><a href="https://doi.org/10.18637/jss.v014.i06" class="external-link">https://doi.org/10.18637/jss.v014.i06</a></p>
</blockquote>
</li>
</ul>
<hr>
</div>
<div class="section level4">
<h4 id="symptom-menses-centered-1">Symptom, Menses-centered<a class="anchor" aria-label="anchor" href="#symptom-menses-centered-1"></a>
</h4>
<p>This is what the raw data of symptom looks like across the first (and
only cycle) for ID = 2:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cycle_plot_menses_id_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cycle_plot_individual.html">cycle_plot_individual</a></span><span class="op">(</span></span>
<span>  <span class="va">cycle_df_scaled</span>,</span>
<span>  id <span class="op">=</span> <span class="fl">2</span>, </span>
<span>  <span class="st">"symptom"</span>,</span>
<span>  centering <span class="op">=</span> <span class="st">"menses"</span>,</span>
<span>  y_scale <span class="op">=</span> <span class="st">"raw"</span>,</span>
<span>  include_impute <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  </span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cycle_plot_menses_id_2</span><span class="op">$</span><span class="va">symptom</span><span class="op">$</span><span class="va">Cycle_1</span><span class="op">$</span><span class="va">plot</span></span></code></pre></div>
<p><img src="menstrualcycleR-overview_files/figure-html/cycle_plot_menses_id_2_raw_plot-1.png" width="672"></p>
<p>As you can see, it is difficult to examine any trends. Smoothing
using <code>y_scale = "roll"</code> or
<code>y_scale = "person_centered_roll"</code> will help us understand
what the trajectory looks like for participant ID = 2.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cycle_plot_menses_id_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cycle_plot_individual.html">cycle_plot_individual</a></span><span class="op">(</span></span>
<span>  <span class="va">cycle_df_scaled</span>,</span>
<span>  id <span class="op">=</span> <span class="fl">2</span>, </span>
<span>  <span class="st">"symptom"</span>,</span>
<span>  centering <span class="op">=</span> <span class="st">"menses"</span>,</span>
<span>  y_scale <span class="op">=</span> <span class="st">"roll"</span>,</span>
<span>  include_impute <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  rollingavg <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cycle_plot_menses_id_2</span><span class="op">$</span><span class="va">symptom</span><span class="op">$</span><span class="va">Cycle_1</span><span class="op">$</span><span class="va">plot</span></span></code></pre></div>
<p><img src="menstrualcycleR-overview_files/figure-html/cycle_plot_menses_id_2_roll_plot-1.png" width="672"></p>
<p><strong>Note on Rolling Averages</strong></p>
<p>If <code>y_scale = "person-centered_roll"</code> or
<code>y_scale = "roll"</code> is selected, rolling averages are
calculated using the <code><a href="https://rdrr.io/pkg/zoo/man/rollapply.html" class="external-link">zoo::rollapply()</a></code> function, which
applies a moving average over the time series, with the settings as:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">zoo</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/zoo/man/rollapply.html" class="external-link">rollapply</a></span><span class="op">(</span></span>
<span>  <span class="va">variable</span>,         <span class="co"># vector of values</span></span>
<span>  <span class="va">rollingavg</span>,       <span class="co"># size of the moving window (default = 5 days)</span></span>
<span>  FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="co"># specifies a mean function to apply to each rolling window of values, ignoring missing values</span></span>
<span>  align <span class="op">=</span> <span class="st">"center"</span>, <span class="co"># align the output to the center of the window</span></span>
<span>  fill <span class="op">=</span> <span class="cn">NA</span>,        <span class="co"># fill edges with NA where full window is not available</span></span>
<span>  partial <span class="op">=</span> <span class="cn">TRUE</span>    <span class="co"># allow smaller windows at the beginning and end</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="cycle_plot_individual-output">
<code>cycle_plot_individual</code> Output<a class="anchor" aria-label="anchor" href="#cycle_plot_individual-output"></a>
</h4>
<p><code><a href="../reference/cycle_plot_individual.html">cycle_plot_individual()</a></code> returns a list with two
components accessible for every menses-to-menses cycle that exists for
an individual:</p>
<ol style="list-style-type: decimal">
<li>
<strong>summary</strong>: A summary of the outcome variable at each
5% increment of the scaled cycle timeline with computed deviations/
rolling deviations.</li>
</ol>
<p>“Deviations from person-mean” represent the differences between a
person’s score on a specific day (or other repeated measure interval)
and their usual average (their person-mean). It tells us how much higher
or lower they are compared to their normal, and is used in
“within-person” or “state-level” analyses.</p>
<ol start="2" style="list-style-type: decimal">
<li>
<strong>plot</strong>: A <code>ggplot2</code> object visualizing the
trajectory of the symptom variable across the cycle.</li>
</ol>
<p><strong>summary</strong> and <strong>plot</strong> are accessible for
each menses-to-menses cycle a participant ID has in the dataset.</p>
</div>
<div class="section level4">
<h4 id="cycle_1-summary-for-id-2">Cycle_1 summary for ID = 2<a class="anchor" aria-label="anchor" href="#cycle_1-summary-for-id-2"></a>
</h4>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cycle_plot_menses_id_2</span><span class="op">$</span><span class="va">symptom</span><span class="op">$</span><span class="va">Cycle_1</span><span class="op">$</span><span class="va">summary</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 21 × 7</span></span></span>
<span><span class="co">#&gt;    cycleday_5perc mean_dev mean_dev_roll raw_sx sx_roll cycleday mcyclength</span></span>
<span><span class="co">#&gt;             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>           0       2.29          1.62     5      4.33     15           26</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>           0.05    0.286         1.29     3      4        16           26</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>           0.1    -<span style="color: #BB0000;">0.214</span>        -<span style="color: #BB0000;">0.381</span>    2.5    2.33     17.5         26</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>           0.15   -<span style="color: #BB0000;">1.71</span>         -<span style="color: #BB0000;">1.71</span>     1      1        19           26</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>           0.2    -<span style="color: #BB0000;">1.71</span>         -<span style="color: #BB0000;">1.71</span>     1      1        20           26</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>           0.25   -<span style="color: #BB0000;">1.71</span>         -<span style="color: #BB0000;">1.71</span>     1      1        21           26</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>           0.3    -<span style="color: #BB0000;">1.71</span>         -<span style="color: #BB0000;">1.38</span>     1      1.33     22           26</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>           0.35   -<span style="color: #BB0000;">0.714</span>        -<span style="color: #BB0000;">1.05</span>     2      1.67     23           26</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>           0.4     0.786         0.786    3.5    3.5      24.5         26</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>           0.45    2.29          2.29     5      5        26           26</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 11 more rows</span></span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="cycle_1-plot-for-id-2">Cycle_1 plot for ID = 2<a class="anchor" aria-label="anchor" href="#cycle_1-plot-for-id-2"></a>
</h4>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cycle_plot_menses_id_2</span><span class="op">$</span><span class="va">symptom</span><span class="op">$</span><span class="va">Cycle_1</span><span class="op">$</span><span class="va">plot</span></span></code></pre></div>
<p><img src="menstrualcycleR-overview_files/figure-html/cycle_plot_menses_id_2_plot_access-1.png" width="672"></p>
<p>Cycles can also be examined ovulation-centered.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cycle_plot_ov_id_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cycle_plot_individual.html">cycle_plot_individual</a></span><span class="op">(</span></span>
<span>  <span class="va">cycle_df_scaled</span>,</span>
<span>  id <span class="op">=</span> <span class="fl">2</span>, </span>
<span>  <span class="st">"symptom"</span>,</span>
<span>  centering <span class="op">=</span> <span class="st">"ovulation"</span>,</span>
<span>  y_scale <span class="op">=</span> <span class="st">"roll"</span>,</span>
<span>  include_impute <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  rollingavg <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cycle_plot_ov_id_2</span><span class="op">$</span><span class="va">symptom</span><span class="op">$</span><span class="va">Cycle_1</span><span class="op">$</span><span class="va">plot</span></span></code></pre></div>
<p><img src="menstrualcycleR-overview_files/figure-html/cycle_plot_ov_id_2_summary-1.png" width="672"></p>
<p>All of these plots are ggplot objects and can be edited using the
package <code>ggplot2</code> and saved using the function
<code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave()</a></code>.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="modeling-menstrual-cycle-dynamics-with-generalized-additive-mixed-models-gamms">Modeling Menstrual Cycle Dynamics with Generalized Additive Mixed
Models (GAMMs)<a class="anchor" aria-label="anchor" href="#modeling-menstrual-cycle-dynamics-with-generalized-additive-mixed-models-gamms"></a>
</h2>
<p>Okay — now that you’ve used <code>menstrualcycleR</code> to generate
standardized menstrual cycle time variables and can beautifully
visualize outcomes across the cycle (both at the sample and individual
levels), you may be wondering:</p>
<blockquote>
<p><strong>How do I know if my outcome significantly changes across the
cycle?</strong></p>
</blockquote>
<p>To answer this, we turn to <strong>generalized additive mixed models
(GAMMs)</strong> via the <code>mgcv</code> R package (Wood, 2017). GAMMs
allow you to statistically evaluate whether there are meaningful,
nonlinear changes in your outcome across time in the cycle, while
accounting for repeated measures within individuals.</p>
<p>GAMMs extend linear mixed-effects models by incorporating
<strong>smooth functions</strong> of predictors, allowing researchers to
flexibly estimate curved trajectories without assuming a specific
polynomial shape. This makes them especially well-suited for capturing
the <strong>dynamic and cyclical</strong> nature of menstrual cycle
data.In our examples, we use <strong>thin plate regression
splines</strong> as the basis for smooth terms. Thin plate splines are a
flexible and efficient smoothing method implemented by default in the
<code>mgcv</code> package (Wood, 2017). They work by placing a penalty
on the “wiggliness” of the fitted curve—ensuring the model captures
important trends without overfitting noise.</p>
<p>Key characteristics of smooth functions using thin plate splines:</p>
<ul>
<li>They adapt to the data’s shape without requiring pre-specified knot
placement.</li>
<li>Smoother fits have <strong>lower effective degrees of freedom
(EDF)</strong>; more flexible (wiggly) fits have <strong>higher
EDF</strong>.</li>
<li>Penalization prevents overfitting and enhances generalizability to
new data.</li>
<li>In menstrual cycle modeling, they allow data-driven estimation of
inflection points and asymmetries.</li>
</ul>
<div class="section level3">
<h3 id="model-specifications">Model Specifications<a class="anchor" aria-label="anchor" href="#model-specifications"></a>
</h3>
<p>In our generalized additive mixed model (GAMM) framework, we adopt a
flexible approach that accommodates nonlinear trends and
individual-level variation across the menstrual cycle:</p>
<ul>
<li><p>Models are estimated using <strong>restricted maximum likelihood
(REML)</strong>, which provides stable and unbiased estimates of
smoothness parameters, particularly in mixed-effects settings.</p></li>
<li><p>In the below example, we assume a <strong>Gaussian
distribution</strong> with an <strong>identity link function</strong>
for the outcome variable. However, GAMMs can accommodate a variety of
outcome distributions.<br><strong>Important:</strong> You should always assess the distribution of
residuals and consider alternative families when appropriate (e.g.,
Poisson for count data, binomial for binary outcomes).<br>
See <a href="https://stat.ethz.ch/R-manual/R-devel/library/mgcv/html/family.mgcv.html" class="external-link"><code>family.mgcv</code></a>
and<br>
Wood, S.N., Pya, N., &amp; Saefken, B. (2016). <em>Smoothing parameter
and model selection for general smooth models.</em> <em>Journal of the
American Statistical Association, 111</em>, 1548–1575. <a href="https://doi.org/10.1080/01621459.2016.1180986" class="external-link">https://doi.org/10.1080/01621459.2016.1180986</a></p></li>
<li><p>Both <strong>fixed effects</strong> (population-level trends) and
<strong>random effects</strong> (individual-level variation) are modeled
as <strong>smooth terms</strong>, providing flexibility to capture
nonlinearity without assuming a specific functional form.</p></li>
<li><p>The default basis function smooth terms are constructed with in
<code>mgcv</code> are <strong>thin plate regression splines</strong>;
however for menstrual cycle analyses where we are examining multiple
cycles per person, we will use <strong>cyclic cubic regression
splines</strong> and specifying -1 and +1 as equivalent using the
knots() parameter. These splines are automatically penalized to minimize
overfitting and promote interpretability. Cyclic smooths are used to
designate a natural point in which the the minimum an maximum are
equivalent, and the covariate space wraps around itself. -1 and +1 in
the cyclic_time variable both represent ovulation (or menses-onset when
ovulation-centered), and so we specify this with cyclic
smooths.</p></li>
<li><p>Time-varying predictors created by
<code>menstrualcycleR</code>—such as
<code>scaled_cycleday_impute</code>, <code>scaled_cycleday</code>, or
<code>scaled_cycleday_imp_ov</code>—can be directly included as smooth
terms in the model specification (e.g.,
<code>s(scaled_cycleday_impute)</code>). The corresponding
<code>cyclic_time</code> variables specify -1 and +1 as the same time
point in the cycle (ovulation, when menses-centered and menses-onset =
0; or menses-onset, when ovulation-centered and ovulation = 0). The
<code>cyclic_time</code> variables should be used when using
<strong>cyclic cubic regression splines</strong>, as shown in the
example below. This was also the parameterization used in the main
models in Nagpal et al., 2025.</p></li>
<li><p>Missing data are addressed using <strong>listwise
deletion</strong>: only observations with complete data for the outcome
and all predictors are retained in the model fitting process.
“)</p></li>
</ul>
<p>Compared to traditional modeling strategies (e.g., phase-based
contrasts or linear time effects), GAMMs offer:</p>
<ul>
<li>
<strong>Data-driven flexibility</strong> to model smooth
trends.</li>
<li>Avoidance of arbitrary knot placement or boundary instability.</li>
<li>The ability to model <strong>subject-specific trajectories</strong>
through random smooths.</li>
<li>Easy alignment with biologically meaningful time variables (e.g.,
centered on <strong>menses</strong> or <strong>ovulation</strong>).</li>
</ul>
<p>This modeling framework allows researchers to explore subtle changes
and patterns across the menstrual cycle with greater precision and
interpretability.</p>
<p>We will now demonstrate how to use GAMMs on the sample dataset
provided by <code>menstrualcycleR</code>.</p>
</div>
<div class="section level3">
<h3 id="running-a-gamm">Running a GAMM<a class="anchor" aria-label="anchor" href="#running-a-gamm"></a>
</h3>
<ul>
<li>To utilize the most observations available to us, we will use the
variable <code>cyclic_time_impute</code> as the predictor.</li>
</ul>
<div class="section level4">
<h4 id="data-preparation">Data Preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h4>
<p>Here, we log-transform our outcome variable <code>symptom</code>,
because oftentimes many biological and behavioral outcomes (e.g. hormone
levels, reaction times, symptom scores) are right-skewed.
Log-transforming these outcomes often results in a distribution that is
more symmetric and approximately normal. However, you should always
assess your model for heteroscedascity and examine the distribution of
residuals.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cycle_df_scaled</span><span class="op">$</span><span class="va">symptom_log</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">cycle_df_scaled</span><span class="op">$</span><span class="va">symptom</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="co">#log-transforming our outcome variable symptom</span></span></code></pre></div>
<p>We now create a dataframe called <code>datSX</code> that includes
only complete cases for the variables <code>cyclic_time_impute</code>
and <code>symptom_log</code>.</p>
<p>GAMMs in the <code>mgcv</code> package use <strong>listwise
deletion</strong>, meaning the model will only include rows with
<strong>no missing values</strong> across any variables in the formula.
By pre-filtering the dataset using <code><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases()</a></code>, we can
determine exactly how many observations will be included in the model.
This ensures transparency and avoids confusion when interpreting model
results.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">selected_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cyclic_time_impute"</span>, <span class="st">"symptom_log"</span> <span class="op">)</span></span>
<span><span class="va">datSX</span> <span class="op">&lt;-</span> <span class="va">cycle_df_scaled</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">cycle_df_scaled</span><span class="op">[</span><span class="va">selected_vars</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span></span></code></pre></div>
<p>Let’s run the GAMM!</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datSX</span><span class="op">$</span><span class="va">id</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">datSX</span><span class="op">$</span><span class="va">id</span><span class="op">)</span> <span class="co"># ALWAYS factor id before putting it in a gam formula</span></span>
<span></span>
<span><span class="va">gamm1</span> <span class="op">&lt;-</span> <span class="fu">mgcv</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span></span>
<span>  <span class="va">symptom_log</span> <span class="op">~</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">cyclic_time_impute</span>, bs <span class="op">=</span> <span class="st">"cc"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">id</span>, bs <span class="op">=</span> <span class="st">'re'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">cyclic_time_impute</span>, <span class="va">id</span>, bs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"re"</span>, <span class="st">"cc"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  knots<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cyclic_time_impute <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">datSX</span>, </span>
<span>  method <span class="op">=</span> <span class="st">'REML'</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This model includes:</p>
<ul>
<li><p><strong><code>symptom_log</code></strong><br>
The outcome variable (log-transformed symptom).</p></li>
<li><p><strong><code>s(cyclic_time_impute)</code></strong><br>
A smooth term modeling the <strong>fixed effect</strong> of cycle time
(scaled, centered on menses) across the sample, where -1 and +1 both
represent the same hormonal timepoint across the cycle (ovulation). This
captures <strong>nonlinear, average trends</strong> in the symptom over
the cycle.</p></li>
<li><p><strong><code>s(id, bs = 're')</code></strong><br>
A <strong>random intercept</strong> for each participant. This accounts
for <strong>individual differences in average symptom
level</strong>.</p></li>
<li><p><strong><code>s(cyclic_time_impute, id, bs = 're')</code></strong><br>
A <strong>random slope</strong>: models how each participant’s cycle
trajectory may deviate from the population-level pattern. This allows
<strong>person-specific nonlinear trends</strong> across the
cycle.</p></li>
<li><p><strong><code>data = datSX</code></strong><br>
The dataset used for model fitting. It should contain only complete
cases for all model variables.</p></li>
<li><p><strong><code>method = 'REML'</code></strong><br>
Fits the model using Restricted Maximum Likelihood, which improves
estimation of smoothness and variance components, especially in the
presence of random effects. “)</p></li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="interpreting-the-gamm-summary-output">Interpreting the GAMM Summary Output<a class="anchor" aria-label="anchor" href="#interpreting-the-gamm-summary-output"></a>
</h3>
<p>After fitting the model with <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam()</a></code>, we can view the
summary with:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">gamm1</span><span class="op">)</span></span></code></pre></div>
<p>This returns several important components:</p>
<div class="section level4">
<h4 id="model-family-link">
<strong>Model Family &amp; Link</strong><a class="anchor" aria-label="anchor" href="#model-family-link"></a>
</h4>
<pre><code>Family: gaussian 
Link function: identity </code></pre>
<ul>
<li>The outcome is modeled using a <strong>Gaussian (normal)
distribution</strong> with an <strong>identity link</strong> (i.e.,
predicted values are on the same scale as the outcome). This is
appropriate for continuous, unbounded outcome variables.</li>
</ul>
<hr>
</div>
<div class="section level4">
<h4 id="model-formula">
<strong>Model Formula</strong><a class="anchor" aria-label="anchor" href="#model-formula"></a>
</h4>
<pre><code><span><span class="va">symptom_log</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">cyclic_time_impute</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">id</span>, bs <span class="op">=</span> <span class="st">"re"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>              <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">cyclic_time_impute</span>, <span class="va">id</span>, bs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"re"</span>, <span class="st">"cc"</span><span class="op">)</span> <span class="op">)</span></span></code></pre>
<ul>
<li>This model includes:
<ul>
<li>A smooth term for <strong>population-level cyclic
trends</strong>.</li>
<li>A <strong>random intercept smooth function</strong> for each
participant.</li>
<li>A <strong>random slope smooth function</strong> capturing
<strong>individual-specific trajectories</strong> across the cycle.</li>
</ul>
</li>
</ul>
<hr>
</div>
<div class="section level4">
<h4 id="parametric-coefficients">
<strong>Parametric Coefficients</strong><a class="anchor" aria-label="anchor" href="#parametric-coefficients"></a>
</h4>
<pre><code>(Intercept)  1.30722    0.01806   72.36   &lt;2e-16 ***</code></pre>
<ul>
<li>The <strong>intercept</strong> represents the average value of the
log-transformed symptom when all smooth terms are at their reference
level.</li>
</ul>
<hr>
</div>
<div class="section level4">
<h4 id="smooth-terms">
<strong>Smooth Terms</strong><a class="anchor" aria-label="anchor" href="#smooth-terms"></a>
</h4>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="fu">s</span>(cyclic_time_impute)     edf <span class="ot">=</span> <span class="fl">7.43</span>   F <span class="ot">=</span> <span class="fl">79.04</span>   p <span class="sc">&lt;</span> <span class="fl">2e-16</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a><span class="fu">s</span>(id)                     edf <span class="ot">=</span> <span class="fl">12.53</span>  F <span class="ot">=</span> <span class="fl">1.31</span>    p <span class="ot">=</span> <span class="fl">0.00106</span> <span class="sc">**</span></span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a><span class="fu">s</span>(cyclic_time_impute,id)  edf <span class="ot">=</span> <span class="fl">15.89</span>  F <span class="ot">=</span> <span class="fl">1.83</span>    p <span class="ot">=</span> <span class="fl">8.36e-05</span> <span class="sc">**</span><span class="er">*</span></span></code></pre></div>
<p>Each smooth term contributes to explaining nonlinear or hierarchical
effects:</p>
<ul>
<li>
<strong><code>s(cyclic_time_impute)</code></strong>:<br>
Captures the <strong>overall nonlinear trend</strong> in symptom
expression across the standardized cycle.
<ul>
<li>The <strong>high edf</strong> (≈7.4) reflects flexibility in the
shape of the curve. Higher edf indicates more “wiggles” and complexity
in the nonlinear pattern.</li>
<li>The <strong>very small p-value</strong> suggests this
population-level pattern is <strong>strongly significant</strong> for
nonlinearity</li>
</ul>
</li>
<li>
<strong><code>s(id, bs = "re")</code></strong>:<br>
Models <strong>random intercept</strong> to account for <strong>baseline
differences</strong> across individuals.
<ul>
<li>The significant p-value (<code>p = 0.001</code>) indicates
meaningful variation in symptom baseline levels.</li>
</ul>
</li>
<li>
<strong><code>s(cyclic_time_impute, id, bs = "re")</code></strong>:<br>
Captures <strong>individual-specific deviations</strong> from the
average symptom trajectory across the cycle.
<ul>
<li>The effect is <strong>statistically significant</strong>
(<code>p = 8.36e-05</code>), indicating nonlinear
<strong>heterogeneity</strong> in how individuals experience symptom
changes across time.</li>
</ul>
</li>
</ul>
<hr>
</div>
<div class="section level4">
<h4 id="model-fit">
<strong>Model Fit</strong><a class="anchor" aria-label="anchor" href="#model-fit"></a>
</h4>
<pre><code>R-sq.(adj) =  0.533   
Deviance explained = 56.2%
-REML = 117.46  
Scale est. = 0.076068   
n = 575</code></pre>
<ul>
<li><p><strong>Adjusted R²</strong> of 0.533:<br>
The model explains over <strong>53% of the variance</strong> in the
log-transformed symptom outcome. It is roughly the squared correlation
between observed and fitted values, adjusted for model complexity. It is
used to assess overall model fit when working with Gaussian
models.</p></li>
<li><p><strong>Deviance explained</strong>: Another metric showing over
<strong>56% of outcome variability</strong> is accounted for. Deviance
is a likelihood-based measure, more general than R², but comes from
comparing the model’s deviance (a measure of error) to that of a null
model. It should be used when comparing models or working with
non-normal outcomes.</p></li>
<li><p><strong>REML</strong>:<br>
Indicates the restricted maximum likelihood used in model
fitting—important for selecting smoothing parameters in GAMs.</p></li>
<li><p><strong>n = 575</strong>:<br>
The number of complete observations included in the model after listwise
deletion.</p></li>
</ul>
<hr>
<blockquote>
<p>These results suggest that on average, <code>symptom</code> varies
significantly across the cycle in a nonlinear way, and that individuals
also show <strong>unique, person-specific patterns</strong> of
<code>symptom</code> change over time – i.e. there are significant
individual differences in nonlinear trends across the cycle.</p>
</blockquote>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="visualizing-your-gamm-across-the-menstrual-cycle">Visualizing your GAMM across the menstrual cycle<a class="anchor" aria-label="anchor" href="#visualizing-your-gamm-across-the-menstrual-cycle"></a>
</h3>
<p>The best way to understand the nonlinear trend of an outcome,
described by a GAMM, across the menstrual cycle is to plot it. Future
iterations of <code>menstrualcycleR</code> may include model-implied
plotting functions, but for now we will share the code below.</p>
<div class="section level4">
<h4 id="first-we-need-to-compute-predicted-or-model-implied-values">First, we need to compute predicted or model-implied values<a class="anchor" aria-label="anchor" href="#first-we-need-to-compute-predicted-or-model-implied-values"></a>
</h4>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plotdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>cyclic_time_impute <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>                      id <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># setting id = 0 suppresses random effects, to model the just the fixed effect (sample-wide) of your outcome across the cycle</span></span>
<span></span>
<span><span class="co"># Predict using the model for each dataset and add predictions</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu">marginaleffects</span><span class="fu">::</span><span class="fu"><a href="https://marginaleffects.com/man/r/predictions.html" class="external-link">predictions</a></span><span class="op">(</span><span class="va">gamm1</span>, newdata <span class="op">=</span> <span class="va">plotdat</span>, type <span class="op">=</span> <span class="st">"response"</span>, transform <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># applying a transform function, to undo to the log transformation on symptom. The transform can be removed if your outcome was not log-transformed </span></span>
<span><span class="va">plotdat</span><span class="op">$</span><span class="va">estimate</span> <span class="op">=</span> <span class="va">pred</span><span class="op">$</span><span class="va">estimate</span></span>
<span><span class="va">plotdat</span><span class="op">$</span><span class="va">conf.low</span> <span class="op">=</span> <span class="va">pred</span><span class="op">$</span><span class="va">conf.low</span></span>
<span><span class="va">plotdat</span><span class="op">$</span><span class="va">conf.high</span> <span class="op">=</span> <span class="va">pred</span><span class="op">$</span><span class="va">conf.high</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="plotting-model-implied-values">Plotting model-implied values<a class="anchor" aria-label="anchor" href="#plotting-model-implied-values"></a>
</h4>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plotting</span></span>
<span><span class="va">gamplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plotdat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cyclic_time_impute</span>, y <span class="op">=</span> <span class="va">estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.50</span><span class="op">)</span>, </span>
<span>                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ovulation"</span>, <span class="st">"50%L"</span>, <span class="st">"Menses Onset"</span>, <span class="st">"50%F"</span>, <span class="st">"Ovulation"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"Symptom"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># You can change the y-axis label to reflect your outcome</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span>xmin <span class="op">=</span><span class="op">-</span><span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">0.08</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>            fill <span class="op">=</span> <span class="st">"grey70"</span>, alpha <span class="op">=</span> <span class="fl">0.2</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="fl">0.92</span>, xmax <span class="op">=</span> <span class="fl">1</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>            fill <span class="op">=</span> <span class="st">"grey87"</span>, alpha <span class="op">=</span> <span class="fl">0.2</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, xmax <span class="op">=</span> <span class="op">-</span><span class="fl">0.92</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>            fill <span class="op">=</span> <span class="st">"grey87"</span>, alpha <span class="op">=</span> <span class="fl">0.2</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span>, show.legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Adding CI ribbon with translucent light grey color</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">conf.low</span>, ymax <span class="op">=</span> <span class="va">conf.high</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"lightgrey"</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use `linewidth` instead.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span>
<span></span>
<span><span class="co"># Print the plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gamplot</span><span class="op">)</span></span></code></pre></div>
<p><img src="menstrualcycleR-overview_files/figure-html/gam_plot-1.png" width="672"></p>
</div>
</div>
<div class="section level3">
<h3 id="understanding-effect-sizes-in-a-multilevel-context">Understanding Effect Sizes in a Multilevel Context<a class="anchor" aria-label="anchor" href="#understanding-effect-sizes-in-a-multilevel-context"></a>
</h3>
<p>When analyzing data with repeated observations per participant—such
as daily symptom ratings across the menstrual cycle—it’s essential to
understand how variability in the outcome can arise from both
within-person (day-to-day fluctuations) and between-person
(individual/trait-like differences) sources. Multilevel or hierarchical
models, including Generalized Additive Mixed Models (GAMMs), are
designed to account for this structure by estimating fixed and random
effects.</p>
<div class="section level4">
<h4 id="why-multilevel-effect-sizes-matter">Why Multilevel Effect Sizes Matter<a class="anchor" aria-label="anchor" href="#why-multilevel-effect-sizes-matter"></a>
</h4>
<p>Effect sizes in multilevel models are more complex than in simple
regression because they are tied to variance components across levels of
the model:</p>
<ul>
<li>
<strong>Fixed effects</strong> estimate average trends across the
entire sample.</li>
<li>
<strong>Random effects</strong> capture how individuals deviate from
those average trends.</li>
<li>
<strong>Within-person effects</strong> describe day-to-day
fluctuations across time.</li>
<li>
<strong>Between-person effects</strong> describe how individuals
differ in their average level of an outcome.</li>
</ul>
<p>In the context of menstrual cycle research, we are particularly
interested in how much of the variation in an outcome (e.g., mood,
sleep, pain) can be attributed to:</p>
<ul>
<li>A sample-wide, average effect of the cycle (<strong>fixed effect of
the cycle and within-person</strong>).</li>
<li>Individual differences in how people change across the cycle
(<strong>random slope of the cycle and within-person</strong>).</li>
<li>Stable individual differences not explained by the cycle
(<strong>random intercept and between-person</strong>).</li>
</ul>
</div>
<div class="section level4">
<h4 id="partitioning-variance-a-primer">Partitioning Variance: A Primer<a class="anchor" aria-label="anchor" href="#partitioning-variance-a-primer"></a>
</h4>
<p>The GAMM summary output includes the <code>Deviance explained</code>
statistic, which represents the proportion of total outcome variance
explained by the model. To understand <strong>outcome variance NOT
explained by the model</strong>:</p>
<ul>
<li><p><strong>Residual variance = 1 -
<code>Deviance explained</code></strong><br>
This quantifies the <strong>within-person error</strong>—that is, how
much outcome variability is <em>not</em> accounted for by the model. In
menstrual cycle research, this residual reflects symptom fluctuations
that do not align with any fixed or random cycle pattern.</p></li>
<li><p>The <strong>random intercept</strong> component can be
interpreted analogously. It can be considered to capture
<strong>between-person error</strong>: the degree to which individuals
differ in their average level of the outcome. In other words, it
reflects <strong>stable individual differences</strong> unrelated to
cycle timing.</p></li>
</ul>
<hr>
<p>While the <code>Deviance explained</code> statistic represents the
overall proportion of variance in the outcome explained by the model,
this is a composite value and does not distinguish between within-person
and between-person variance.</p>
<p>To disentangle this, we turn to frameworks like that of Rights &amp;
Sterba (2019), which detail how to attribute variance to various fixed
and random components. For GAMMs, we can extend this framework by using
tools like the <code>gam.hp</code> package to quantify variance
explained by specific predictors and determine whether they operate at
the within- or between-person level.</p>
<p>Below is a table summarizing the key types of predictors in menstrual
cycle multilevel modeling and their interpretation, specific to
menstrual cycle research:</p>
<table class="table">
<caption>Understanding Multilevel Effects in Menstrual Cycle
Modeling</caption>
<colgroup>
<col width="5%">
<col width="4%">
<col width="11%">
<col width="21%">
<col width="57%">
</colgroup>
<thead><tr class="header">
<th align="left">Level</th>
<th align="left">Effect Type</th>
<th align="left">GAMM Parameter</th>
<th align="left">Description</th>
<th align="left">Relevance to Cycle Research</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Level-1/Within-person</td>
<td align="left">Fixed effect</td>
<td align="left">s(cyclic_time_impute)</td>
<td align="left">Average within-person change across the time</td>
<td align="left">Captures overall dynamic pattern across the cycle</td>
</tr>
<tr class="even">
<td align="left">Level-1/Within-person</td>
<td align="left">Random slope</td>
<td align="left">s(cyclic_time_impute, id, bs = c(‘cc’, ‘re’))</td>
<td align="left">Individual differences in trajectories of outcome
across time</td>
<td align="left">Accounts for heterogeneity/individual differences in
outcomes across the cycle</td>
</tr>
<tr class="odd">
<td align="left">Level-2/Between-person</td>
<td align="left">Intercept</td>
<td align="left">Parametric Intercept</td>
<td align="left">Average value outcome value when all other predictors
are at their reference level</td>
<td align="left">Average level of outcome in the data</td>
</tr>
<tr class="even">
<td align="left">Level-2/Between-person</td>
<td align="left">Random intercept</td>
<td align="left"><code>s(id, bs = 're')</code></td>
<td align="left">Between-person differences in average outcome
levels</td>
<td align="left">These differences in between-person traits cannot be
explained by cycle predictors and can be considered a type of
<code>error</code>. They may be explained by other between-person
variables not included in the model, such as age or BMI</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="key-takeaway">Key Takeaway<a class="anchor" aria-label="anchor" href="#key-takeaway"></a>
</h4>
<p>The menstrual cycle is inherently a <strong>within-person
predictor</strong>—a time-varying process experienced repeatedly across
individuals. When fitting models like GAMMs, we want to understand how
much of the <strong>within-person variance</strong> in symptoms is
explained by the cycle on average (fixed effect), and how much is
explained by <strong>individual-specific cycle trajectories</strong>
(random slopes). The <strong>random intercept</strong> represents
<strong>between-person differences in symptom levels</strong>, which may
reflect stable traits not driven by the cycle.</p>
<p>We can partition model variance into these components, using the
<code>gam.hp</code> package (Lai, et al., 2024). This helps us gain a
clearer understanding of both the <strong>reliability</strong> and
<strong>individual variability</strong> in menstrual cycle effects—a
crucial goal for rigorous cycle science.</p>
</div>
<div class="section level4">
<h4 id="hierarchical-variance-partitioning-with-gam-hp">Hierarchical Variance Partitioning with <code>gam.hp</code><a class="anchor" aria-label="anchor" href="#hierarchical-variance-partitioning-with-gam-hp"></a>
</h4>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">var.part</span> <span class="op">=</span> <span class="fu">gam.hp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gam.hp/man/gam.hp.html" class="external-link">gam.hp</a></span><span class="op">(</span><span class="va">gamm1</span><span class="op">)</span></span>
<span><span class="va">var.part</span><span class="op">$</span><span class="va">hierarchical.partitioning</span> </span>
<span><span class="co">#&gt;                                          Unique Average.share Individual</span></span>
<span><span class="co">#&gt; s(cyclic_time_impute,bs="cc")            0.5480       -0.0342     0.5138</span></span>
<span><span class="co">#&gt; s(id,bs="re")                            0.0337       -0.0129     0.0208</span></span>
<span><span class="co">#&gt; s(cyclic_time_impute,id,bs=c("re","cc")) 0.0443       -0.0167     0.0276</span></span>
<span><span class="co">#&gt;                                          I.perc(%)</span></span>
<span><span class="co">#&gt; s(cyclic_time_impute,bs="cc")                91.39</span></span>
<span><span class="co">#&gt; s(id,bs="re")                                 3.70</span></span>
<span><span class="co">#&gt; s(cyclic_time_impute,id,bs=c("re","cc"))      4.91</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="64%">
<col width="35%">
</colgroup>
<thead><tr class="header">
<th>Column Name</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Unique</strong></td>
<td>The unique variance explained by this term alone, not shared with
other terms in the model. This represents the proportion of variance
<em>exclusively</em> attributable to that specific predictor.</td>
</tr>
<tr class="even">
<td><strong>Average.share</strong></td>
<td>The average proportion of shared variance across all predictors in
the model. A negative value may appear when shared variance is low or
suppressor effects are present.</td>
</tr>
<tr class="odd">
<td><strong>Individual</strong></td>
<td>The sum of the Unique and Average.share columns, representing the
<strong>total contribution</strong> (both unique and shared) of this
predictor to the model’s explained variance. This column provides an
estimate of each predictor’s contribution to <strong>total outcome
variance</strong>
</td>
</tr>
<tr class="even">
<td><strong>I.perc(%)</strong></td>
<td>The <strong>percentage</strong> of the <strong>total model-explained
variance</strong> attributed to this term. Useful for comparing the
relative importance of each component.</td>
</tr>
</tbody>
</table>
<p>While model-explained variance can differ based on model parameters,
the total outcome variance is stable for a particular outcome in a
dataset. Proportion of total outcome variance can be compared between
models with the same outcome to understand the influence of different
predictors. For this reason, we interpret the
<strong>Individual</strong> column of the <code>gam.hp</code>
output:</p>
<ul>
<li><p><strong>s(cyclic_time_impute)</strong>:<br>
The <strong>fixed effect of cycle time</strong> explains
<strong>51.4%</strong> (0.5138) of <strong>total outcome
variance</strong>. This shows that a large portion of outcome variation
is captured by average, population-level cycle dynamics.</p></li>
<li><p><strong>s(id, bs = “re”)</strong>:<br>
The <strong>random intercept</strong> explains <strong>2.1%</strong>
(0.0208) of <strong>total outcome variance</strong>. This reflects
<strong>between-person differences</strong> in average outcome
level—i.e., individual baselines not explained by cycle dynamics but
could be explained by unmeasured trait variables (e.g. age,
BMI).</p></li>
<li><p><strong>s(cyclic_time_impute, id)</strong>:<br>
The <strong>random slope effect</strong> explains <strong>2.76%</strong>
(0.0276) of <strong>total outcome variance</strong>. This reflects
<strong>individual differences in trajectories of the outcome across the
cycle</strong>, above and beyond the average pattern.</p></li>
</ul>
<p>Okay now that we understand how variance can be partitioned in
multilevel models and in GAMMs, lets take a look at calculating
<strong>total within-person variance</strong> and <strong>within-person
variance accounted for by the cycle</strong>.</p>
</div>
<div class="section level4">
<h4 id="proportion-of-total-within-person-variance">Proportion of Total Within-Person Variance<a class="anchor" aria-label="anchor" href="#proportion-of-total-within-person-variance"></a>
</h4>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Step 1: Create the data frame</span></span>
<span><span class="va">variance_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Component <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Fixed effect of the cycle"</span>, </span>
<span>                <span class="st">"Random slope of the cycle"</span>, </span>
<span>                <span class="st">"Within-person residual"</span><span class="op">)</span>,</span>
<span>  Term <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s(cyclic_time_impute)"</span>, </span>
<span>           <span class="st">"s(cyclic_time_impute, id)"</span>, </span>
<span>           <span class="st">"Residual (1 - Deviance Explained)"</span><span class="op">)</span>,</span>
<span>  Proportion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5138</span>, <span class="fl">0.0276</span>, <span class="fl">0.438</span><span class="op">)</span>  </span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Normalize </span></span>
<span><span class="va">variance_df</span> <span class="op">&lt;-</span> <span class="va">variance_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Percent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">Proportion</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Proportion</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>         Label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">Component</span>, <span class="st">"\n"</span>, <span class="va">Percent</span>, <span class="st">"%"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 2: Display table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">variance_df</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Component"</span>, <span class="st">"Term"</span>, <span class="st">"Proportion"</span><span class="op">)</span><span class="op">]</span>, </span>
<span>      col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Component"</span>, <span class="st">"Model Term"</span>, <span class="st">"Proportion of Within-Person Variance"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="26%">
<col width="35%">
<col width="38%">
</colgroup>
<thead><tr class="header">
<th align="left">Component</th>
<th align="left">Model Term</th>
<th align="right">Proportion of Within-Person Variance</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Fixed effect of the cycle</td>
<td align="left">s(cyclic_time_impute)</td>
<td align="right">0.5138</td>
</tr>
<tr class="even">
<td align="left">Random slope of the cycle</td>
<td align="left">s(cyclic_time_impute, id)</td>
<td align="right">0.0276</td>
</tr>
<tr class="odd">
<td align="left">Within-person residual</td>
<td align="left">Residual (1 - Deviance Explained)</td>
<td align="right">0.4380</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Step 3: Create pie chart</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">variance_df</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="va">Proportion</span>, fill <span class="op">=</span> <span class="va">Label</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_polar.html" class="external-link">coord_polar</a></span><span class="op">(</span><span class="st">"y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Total Within-person Variance"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="menstrualcycleR-overview_files/figure-html/total_within_person-1.png" width="576"></p>
</div>
<div class="section level4">
<h4 id="within-person-variance-accounted-for-by-the-menstrual-cycle">Within-person Variance Accounted for by the Menstrual Cycle<a class="anchor" aria-label="anchor" href="#within-person-variance-accounted-for-by-the-menstrual-cycle"></a>
</h4>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Step 1: Create the data frame</span></span>
<span><span class="va">variance_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Component <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Fixed effect of the cycle"</span>, </span>
<span>                <span class="st">"Random slope of the cycle"</span><span class="op">)</span>,</span>
<span>  Term <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s(cyclic_time_impute)"</span>, </span>
<span>           <span class="st">"s(cyclic_time_impute, id)"</span><span class="op">)</span>,</span>
<span>  Proportion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5138</span>, <span class="fl">0.0276</span><span class="op">)</span>  </span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Normalize </span></span>
<span><span class="va">variance_df</span> <span class="op">&lt;-</span> <span class="va">variance_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Percent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">Proportion</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Proportion</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>         Label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">Component</span>, <span class="st">"\n"</span>, <span class="va">Percent</span>, <span class="st">"%"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 2: Display table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">variance_df</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Component"</span>, <span class="st">"Term"</span>, <span class="st">"Proportion"</span><span class="op">)</span><span class="op">]</span>, </span>
<span>      col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Component"</span>, <span class="st">"Model Term"</span>, <span class="st">"Within-Person Variance Accounted for by the Cycle"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="25%">
<col width="25%">
<col width="49%">
</colgroup>
<thead><tr class="header">
<th align="left">Component</th>
<th align="left">Model Term</th>
<th align="right">Within-Person Variance Accounted for by the Cycle</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Fixed effect of the cycle</td>
<td align="left">s(cyclic_time_impute)</td>
<td align="right">0.5138</td>
</tr>
<tr class="even">
<td align="left">Random slope of the cycle</td>
<td align="left">s(cyclic_time_impute, id)</td>
<td align="right">0.0276</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Step 3: Create pie chart</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">variance_df</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="va">Proportion</span>, fill <span class="op">=</span> <span class="va">Label</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_polar.html" class="external-link">coord_polar</a></span><span class="op">(</span><span class="st">"y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Within-person Variance accounted for by the cycle"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="menstrualcycleR-overview_files/figure-html/total_within_person_cycle-1.png" width="576"></p>
</div>
<div class="section level4">
<h4 id="interpreting-effect-sizes-and-cycle-explained-variance">Interpreting Effect Sizes and Cycle-Explained Variance<a class="anchor" aria-label="anchor" href="#interpreting-effect-sizes-and-cycle-explained-variance"></a>
</h4>
<p>Understanding what constitutes a meaningful effect size or clinically
significant cycle-explained variance in menstrual cycle research is
still an evolving area. While no universal benchmarks currently exist,
it is important to consider how statistical variance relates to
<strong>clinically meaningful changes</strong> in outcomes across the
cycle.</p>
<p>By reporting <strong>variance partitioning metrics</strong>—such as
breakdowns of total variance, total within-person variance, and
within-person variance explained by the cycle—you contribute to a
growing body of research that aims to clarify what levels of
cycle-related variance are meaningful. Including these metrics provides
<strong>greater transparency</strong>, promotes <strong>comparability
across studies</strong>, and supports the development of
<strong>evidence-based thresholds</strong> for interpreting effects in
menstrual cycle research.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li><p>Eisenlohr-Moul, T. A., Girdler, S. S., Schmalenberger, K. M.,
Dawson, D. N., Surana, P., Johnson, J. L., &amp; Rubinow, D. R. (2017).
<em>Toward the reliable diagnosis of DSM-5 premenstrual dysphoric
disorder: The Carolina Premenstrual Assessment Scoring System
(C-PASS)</em>. <em>American Journal of Psychiatry, 174</em>(1), 51–59.
<a href="https://doi.org/10.1176/appi.ajp.2016.15121510" class="external-link uri">https://doi.org/10.1176/appi.ajp.2016.15121510</a></p></li>
<li><p>Eisenlohr-Moul, T. A., Kaiser, G., Weise, C., Schmalenberger, K.
M., Kiesner, J., Ditzen, B., &amp; Kleinstäuber, M. (2020). <em>Are
there temporal subtypes of premenstrual dysphoric disorder?: Using
group-based trajectory modeling to identify individual differences in
symptom change.</em> <em>Psychological Medicine, 50(6)</em>, 964–972. <a href="https://doi.org/10.1017/S0033291719000849" class="external-link uri">https://doi.org/10.1017/S0033291719000849</a></p></li>
<li><p>Lai, J., Tang, J., Li, T., Zhang, A., &amp; Mao, L. (2024).
<em>Evaluating the relative importance of predictors in Generalized
Additive Models using the gam.hp R package</em>. <em>Plant Diversity,
46</em>(4), 542–546. <a href="https://doi.org/10.1016/j.pld.2024.06.002" class="external-link uri">https://doi.org/10.1016/j.pld.2024.06.002</a></p></li>
<li><p>Nagpal, A., Schmalenberger, K. M., Barone, J., Mulligan, E. M.,
Stumper, A., Knol, L., … Eisenlohr-Moul, T. A., PhD. (2025, May 6).
<em>Studying the Menstrual Cycle as a Continuous Variable: Implementing
Phase-Aligned Cycle Time Scaling (PACTS) with the
<code>menstrualcycleR</code> package</em>. <a href="https://doi.org/10.31219/osf.io/hd5xw_v1" class="external-link uri">https://doi.org/10.31219/osf.io/hd5xw_v1</a></p></li>
<li><p>Reen, E., &amp; Kiesner, J. (2016). Individual differences in
self-reported difficulty sleeping across the menstrual cycle.
<em>Archives of Women’s Mental Health, 19</em>(4), 599–608. <a href="https://doi.org/10.1007/s00737-016-0621-9" class="external-link uri">https://doi.org/10.1007/s00737-016-0621-9</a></p></li>
<li><p>Rights, J. D., &amp; Sterba, S. K. (2019). <em>Quantifying
explained variance in multilevel models: An integrative framework for
defining R-squared measures</em>. <em>Psychological Methods, 24</em>(3),
309–338. <a href="https://doi.org/10.1037/met0000184" class="external-link uri">https://doi.org/10.1037/met0000184</a></p></li>
<li><p>Schmalenberger, K. M., Tauseef, H. A., Barone, J. C., Owens, S.
A., Lieberman, L., Jarczok, M. N., Girdler, S. S., Kiesner, J., Ditzen,
B., &amp; Eisenlohr-Moul, T. A. (2021). <em>How to study the menstrual
cycle: Practical tools and recommendations</em>.
<em>Psychoneuroendocrinology, 123</em>, 104895. <a href="https://doi.org/10.1016/j.psyneuen.2020.104895" class="external-link uri">https://doi.org/10.1016/j.psyneuen.2020.104895</a></p></li>
<li><p>Symul, L., &amp; Eisenlohr-Moul, T. (2025). <em>cpass: PMDD and
MRMD diagnoses following the Carolina Premenstrual Assessment Scoring
System (C-PASS)</em> (R package version 0.1.0).</p></li>
<li><p>Wood, S.N., Pya, N., &amp; Saefken, B. (2016). <em>Smoothing
parameter and model selection for general smooth models</em>. Journal of
the American Statistical Association, 111, 1548–1575. <a href="https://doi.org/10.1080/01621459.2016.1180986" class="external-link uri">https://doi.org/10.1080/01621459.2016.1180986</a></p></li>
<li><p>Wood, S. N. (2017). <em>Generalized Additive Models: An
Introduction with R</em> (2nd ed.). Chapman and Hall/CRC.</p></li>
<li><p>Zeileis, A., &amp; Grothendieck, G. (2005). zoo: S3
infrastructure for regular and irregular time series. <em>Journal of
Statistical Software</em>, <em>14</em>(6), 1–27. <a href="https://doi.org/10.18637/jss.v014.i06" class="external-link uri">https://doi.org/10.18637/jss.v014.i06</a></p></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anisha Nagpal, Tory Eisenlohr-Moul.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
