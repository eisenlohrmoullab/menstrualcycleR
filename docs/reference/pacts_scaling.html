<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Phase-Aligned Cycle Time Scaling (PACTS) — pacts_scaling • menstrualcycleR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Phase-Aligned Cycle Time Scaling (PACTS) — pacts_scaling"><meta name="description" content="This function uses the Phase-Aligned Cycle Time Scaling (PACTS) method, as described in Nagpal et al. (2025), to compute continuous, biologically meaningful cycle time variables in a long-format dataset, where each row represents a unique observation date for a specific naturally-cycling individual."><meta property="og:description" content="This function uses the Phase-Aligned Cycle Time Scaling (PACTS) method, as described in Nagpal et al. (2025), to compute continuous, biologically meaningful cycle time variables in a long-format dataset, where each row represents a unique observation date for a specific naturally-cycling individual."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">menstrualcycleR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/menstrualcycleR-overview.html">Getting Started with menstrualcycleR and Phase-Aligned Cycle Time Scaling (PACTS)</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Phase-Aligned Cycle Time Scaling (PACTS)</h1>

      <div class="d-none name"><code>pacts_scaling.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function uses the Phase-Aligned Cycle Time Scaling (PACTS) method, as described in Nagpal et al. (2025), to compute continuous, biologically meaningful cycle time variables in a long-format dataset, where each row represents a unique observation date for a specific naturally-cycling individual.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pacts_scaling</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">id</span>,</span>
<span>  <span class="va">date</span>,</span>
<span>  <span class="va">menses</span>,</span>
<span>  <span class="va">ovtoday</span>,</span>
<span>  lower_cyclength_bound <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  upper_cyclength_bound <span class="op">=</span> <span class="fl">35</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame containing the required input variables.</p></dd>


<dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>A unique identifier for each naturally-cycling individual in the dataset.</p></dd>


<dt id="arg-date">date<a class="anchor" aria-label="anchor" href="#arg-date"></a></dt>
<dd><p>A date column corresponding to the day of observation. Ensure all id-date combinations are unique. You may wish to reclassify post-midnight survey entries to the previous day to maintain alignment with sleep or daily tracking data.</p></dd>


<dt id="arg-menses">menses<a class="anchor" aria-label="anchor" href="#arg-menses"></a></dt>
<dd><p>A binary column (<code>0</code>/<code>1</code>) indicating the <em>first</em> day of menses onset, where <code>1</code> marks onset. All subsequent bleeding days should be set to <code>0</code>. Periovulatory spotting should also be excluded.</p></dd>


<dt id="arg-ovtoday">ovtoday<a class="anchor" aria-label="anchor" href="#arg-ovtoday"></a></dt>
<dd><p>A binary column (<code>0</code>/<code>1</code>) indicating the day of estimated ovulation. Required even if biomarkers were not collected—use a column of all <code>0</code>s or <code>NA</code>s in that case. Accepted ovulation determination methods include:</p><ul><li><p><strong>Urinary LH surge tests</strong>: Code <code>ovtoday == 1</code> on the day <em>after</em> the first positive test (LH +1). Specify the brand and threshold (e.g., 40 mIU/ml).</p></li>
<li><p><strong>Basal body temperature (BBT)</strong>: Code <code>ovtoday == 1</code> on the day after the BBT nadir (BBT +1). Specify measurement method.</p></li>
<li><p><strong>Daily hormone assays</strong>: See Nagpal et al. (2025) for guidance.</p></li>
</ul></dd>


<dt id="arg-lower-cyclength-bound">lower_cyclength_bound<a class="anchor" aria-label="anchor" href="#arg-lower-cyclength-bound"></a></dt>
<dd><p>Numeric lower bound of cycle lengths to include in scaling. Default is 21.</p></dd>


<dt id="arg-upper-cyclength-bound">upper_cyclength_bound<a class="anchor" aria-label="anchor" href="#arg-upper-cyclength-bound"></a></dt>
<dd><p>Numeric upper bound of cycle lengths to include in scaling. Default is 35.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The original data frame with the following additional columns:</p><ul><li><p><code>scaled_cycleday</code>: A continuous cycle time variable centered on menses onset (<code>menses == 1</code> → 0), ranging from -1 (start of luteal phase) to +1 (ovulation). Only includes cycles with biomarker-confirmed ovulation.</p></li>
<li><p><code>scaled_cycleday_impute</code>: Same as above, but includes cycles where ovulation was imputed using day -15. Offers broader coverage across the dataset, at the cost of lower precision.</p></li>
<li><p><code>scaled_cycleday_ov</code>: A cycle time variable centered on ovulation day (<code>ovtoday == 1</code> → 0), ranging from -1 (start of follicular phase) to +1 (end of luteal phase). Only includes cycles with confirmed ovulation.</p></li>
<li><p><code>scaled_cycleday_imp_ov</code>: Same as above, but uses imputed ovulation (<code>ovtoday_impute == 1</code>) for cycles lacking biomarker confirmation. Centered on either confirmed or imputed ovulation.</p></li>
<li><p><code>ovtoday_impute</code>: A binary column indicating imputed ovulation days (value <code>1</code>) for cycles without confirmed ovulation, estimated as 15 days before menses onset.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The PACTS method aligns observations across cycles by centering time either on menses onset or ovulation. This allows researchers to model menstrual cycle dynamics as continuous functions of time, improving sensitivity and interpretability. The function requires identification of menses onset (<code>menses</code>) and the estimated day of ovulation (<code>ovtoday</code>), which may be determined via biomarker (preferred) or imputed based on typical luteal phase length when unavailable.</p>
<p>When ovulation is not directly assessed, the function imputes ovulation as 15 days prior to the next menses onset (i.e., the last day of the follicular phase), based on the population-average luteal phase length. Imputed ovulation days are recorded in a new binary column, <code>ovtoday_impute</code>.</p>
<p>Reporting how often ovulation was confirmed using biomarkers versus imputed is important for transparency and scientific rigor. Whenever possible, researchers should use objective biomarkers such as LH tests or basal body temperature (BBT) to identify ovulation, as these methods provide greater precision. This function supports both confirmed and imputed ovulation, allowing analyses to flexibly account for variable data availability across participants and cycles.</p>
<p>For further guidance on ovulation identification and justification of the -15 day imputation approach, see:</p><ul><li><p>Nagpal et al. (2025). <em>Studying the Menstrual Cycle as a Continuous Variable: Implementing Phase-Aligned Cycle Time Scaling (PACTS) with the <code>menstrualcycleR</code> package</em>. https://doi.org/10.31219/osf.io/hd5xw_v1</p></li>
<li><p>Schmalenberger et al. (2021). <em>How to study the menstrual cycle: Practical tools and recommendations</em>. <em>Psychoneuroendocrinology, 123</em>, 104895. https://doi.org/10.1016/j.psyneuen.2020.104895</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load the example dataset</span></span></span>
<span class="r-in"><span><span class="va">cycle_df</span> <span class="op">=</span> <span class="va">cycledata</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">data_with_scaling</span> <span class="op">&lt;-</span> <span class="fu">pacts_scaling</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">cycle_df</span>, </span></span>
<span class="r-in"><span>  id <span class="op">=</span> <span class="va">id</span>, </span></span>
<span class="r-in"><span>  date <span class="op">=</span> <span class="va">daterated</span>, </span></span>
<span class="r-in"><span>  menses <span class="op">=</span> <span class="va">menses</span>, </span></span>
<span class="r-in"><span>  ovtoday <span class="op">=</span> <span class="va">ovtoday</span>, </span></span>
<span class="r-in"><span>  lower_cyclength_bound <span class="op">=</span> <span class="fl">21</span>, </span></span>
<span class="r-in"><span>  upper_cyclength_bound <span class="op">=</span> <span class="fl">35</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> id: id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> date: date</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> menses: menses</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ovtoday: ovtoday</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in ungroup(.):</span> could not find function "ungroup"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View the result</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">data_with_scaling</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'data_with_scaling' not found</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anisha Nagpal, Tory Eisenlohr-Moul.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

